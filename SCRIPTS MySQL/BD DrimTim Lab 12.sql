-- MySQL Script generated by MySQL Workbench
-- Wed Nov 12 02:24:40 2025
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `mydb` ;

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8mb3 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`Tienda`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Tienda` (
  `idTienda` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(70) NULL DEFAULT NULL,
  `ubicacion` VARCHAR(45) NULL DEFAULT NULL,
  PRIMARY KEY (`idTienda`),
  UNIQUE INDEX `idTienda_UNIQUE` (`idTienda` ASC) VISIBLE)
ENGINE = InnoDB
AUTO_INCREMENT = 2
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Almacen`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Almacen` (
  `idAlmacen` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(70) NULL DEFAULT NULL,
  `ubicacion` VARCHAR(70) NULL DEFAULT NULL,
  `stock` INT NOT NULL,
  `Tienda_idTienda` INT NOT NULL,
  `Activo` TINYINT NOT NULL,
  PRIMARY KEY (`idAlmacen`),
  INDEX `fk_Almacen_Tienda1_idx` (`Tienda_idTienda` ASC) VISIBLE,
  CONSTRAINT `fk_Almacen_Tienda1`
    FOREIGN KEY (`Tienda_idTienda`)
    REFERENCES `mydb`.`Tienda` (`idTienda`))
ENGINE = InnoDB
AUTO_INCREMENT = 6
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Prenda`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Prenda` (
  `idPrenda` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(100) NOT NULL,
  `color` VARCHAR(30) NULL DEFAULT NULL,
  `stockPrenda` INT NOT NULL DEFAULT '0',
  `alertaMinStock` INT NOT NULL,
  `activo` TINYINT NOT NULL,
  `precioUnidad` DECIMAL(10,2) NOT NULL DEFAULT '0.00',
  `precioMayor` DECIMAL(10,2) NOT NULL DEFAULT '0.00',
  `precioDocena` DECIMAL(10,2) NOT NULL DEFAULT '0.00',
  `material` ENUM('Algodon', 'Poliester', 'Mezcla_algodon_poliester', 'Lino', 'Viscosa_rayon', 'Lana', 'Acrilico', 'Nylon', 'Elastano_lycra', 'Denim', 'Drill', 'Gabardina', 'Polar', 'Franela', 'Cuero', 'Cuerina', 'Saten', 'Chifon') NOT NULL DEFAULT 'Algodon',
  PRIMARY KEY (`idPrenda`))
ENGINE = InnoDB
AUTO_INCREMENT = 45
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Blusa`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Blusa` (
  `idPrenda` INT NOT NULL,
  `tipo_blusa` ENUM('Camisera', 'CropTop', 'Peplum', 'OffShoulder', 'Transparente', 'Formal', 'Casual') NOT NULL,
  `tipo_manga` ENUM('MangaCorta', 'MangaLarga', 'SinManga', 'Globo', 'Campana', 'TresCuartos') NOT NULL,
  PRIMARY KEY (`idPrenda`),
  CONSTRAINT `Blusa_ibfk_1`
    FOREIGN KEY (`idPrenda`)
    REFERENCES `mydb`.`Prenda` (`idPrenda`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`ComprobanteDePago`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ComprobanteDePago` (
  `idComprobante` INT NOT NULL AUTO_INCREMENT,
  `fecha` DATETIME NULL DEFAULT NULL,
  `total` DOUBLE NULL DEFAULT NULL,
  `IGV` DOUBLE NULL DEFAULT NULL,
  `metodoDePago` VARCHAR(45) NULL DEFAULT NULL,
  `correlativo` VARCHAR(45) NULL DEFAULT NULL,
  `activa` TINYINT NULL DEFAULT NULL,
  PRIMARY KEY (`idComprobante`))
ENGINE = InnoDB
AUTO_INCREMENT = 10
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Boleta`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Boleta` (
  `idComprobante` INT NOT NULL,
  `DNI` VARCHAR(8) NULL DEFAULT NULL,
  PRIMARY KEY (`idComprobante`),
  CONSTRAINT `Boleta_ibfk_1`
    FOREIGN KEY (`idComprobante`)
    REFERENCES `mydb`.`ComprobanteDePago` (`idComprobante`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Cargo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Cargo` (
  `idCargo` INT NOT NULL AUTO_INCREMENT,
  `abreviatura` CHAR(1) NULL DEFAULT NULL,
  `descripcion` VARCHAR(75) NULL DEFAULT NULL,
  `activo` TINYINT NOT NULL,
  PRIMARY KEY (`idCargo`))
ENGINE = InnoDB
AUTO_INCREMENT = 9
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Casaca`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Casaca` (
  `idPrenda` INT NOT NULL,
  `tipo_casaca` ENUM('Bomber', 'Puffer', 'Denim', 'Deportiva', 'Cuero', 'Cardigan', 'Otro') NOT NULL,
  `con_capucha` TINYINT NOT NULL DEFAULT '0',
  PRIMARY KEY (`idPrenda`),
  CONSTRAINT `Casaca_ibfk_1`
    FOREIGN KEY (`idPrenda`)
    REFERENCES `mydb`.`Prenda` (`idPrenda`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Persona`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Persona` (
  `idPersona` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(75) NULL DEFAULT NULL,
  `primerApellido` VARCHAR(75) NULL DEFAULT NULL,
  `segundoApellido` VARCHAR(45) NULL DEFAULT NULL,
  `dni` INT NULL DEFAULT NULL,
  `telefono` INT NULL DEFAULT NULL,
  `genero` CHAR(1) NULL DEFAULT NULL,
  PRIMARY KEY (`idPersona`))
ENGINE = InnoDB
AUTO_INCREMENT = 19
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`TipoDeCliente`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`TipoDeCliente` (
  `tipoCliente` INT NOT NULL,
  `abreviatura` CHAR(1) NOT NULL,
  `descripcion` VARCHAR(120) NOT NULL,
  PRIMARY KEY (`tipoCliente`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `mydb`.`Cliente`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Cliente` (
  `idCliente` INT NOT NULL,
  `tipoCliente` INT NOT NULL,
  `activo` TINYINT NOT NULL DEFAULT '1',
  PRIMARY KEY (`idCliente`),
  INDEX `fk_Cliente_Persona10_idx` (`idCliente` ASC) VISIBLE,
  INDEX `fk_Cliente_tipoCliente10_idx` (`tipoCliente` ASC) VISIBLE,
  CONSTRAINT `fk_Cliente_Persona10`
    FOREIGN KEY (`idCliente`)
    REFERENCES `mydb`.`Persona` (`idPersona`),
  CONSTRAINT `fk_Cliente_tipoCliente10`
    FOREIGN KEY (`tipoCliente`)
    REFERENCES `mydb`.`TipoDeCliente` (`tipoCliente`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `mydb`.`Proveedor`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Proveedor` (
  `idProveedor` INT NOT NULL AUTO_INCREMENT,
  `RUC` BIGINT NOT NULL,
  `nombre` VARCHAR(70) NULL DEFAULT NULL,
  `telefono` INT NOT NULL,
  `direccion` VARCHAR(150) NULL DEFAULT NULL,
  `activo` TINYINT NOT NULL,
  PRIMARY KEY (`idProveedor`))
ENGINE = InnoDB
AUTO_INCREMENT = 14
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `mydb`.`CondicionPago`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`CondicionPago` (
  `idCondicion` INT NOT NULL AUTO_INCREMENT,
  `descripcion` VARCHAR(120) NULL DEFAULT NULL,
  `numDias` INT NOT NULL,
  `vigente` TINYINT NOT NULL,
  `Proveedor_idProveedor` INT NOT NULL,
  PRIMARY KEY (`idCondicion`),
  INDEX `fk_Proveedor_idProveedor1_idx` (`Proveedor_idProveedor` ASC) VISIBLE,
  CONSTRAINT `fk_Proveedor_idProveedor1`
    FOREIGN KEY (`Proveedor_idProveedor`)
    REFERENCES `mydb`.`Proveedor` (`idProveedor`))
ENGINE = InnoDB
AUTO_INCREMENT = 17
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `mydb`.`TipoCuenta`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`TipoCuenta` (
  `idTipoCuenta` INT NOT NULL AUTO_INCREMENT,
  `descripcion` VARCHAR(75) NULL DEFAULT NULL,
  `activo` TINYINT NOT NULL,
  PRIMARY KEY (`idTipoCuenta`))
ENGINE = InnoDB
AUTO_INCREMENT = 4
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`CuentaUsuario`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`CuentaUsuario` (
  `idCuenta` INT NOT NULL AUTO_INCREMENT,
  `username` VARCHAR(75) NULL DEFAULT NULL,
  `contrasenha` VARCHAR(75) NULL DEFAULT NULL,
  `activo` TINYINT NOT NULL,
  `email` VARCHAR(75) NULL DEFAULT NULL,
  `TipoCuenta_idTipoCuenta` INT NOT NULL,
  PRIMARY KEY (`idCuenta`, `TipoCuenta_idTipoCuenta`),
  INDEX `fk_CuentaUsuario_TipoCuenta1_idx` (`TipoCuenta_idTipoCuenta` ASC) VISIBLE,
  CONSTRAINT `fk_CuentaUsuario_TipoCuenta1`
    FOREIGN KEY (`TipoCuenta_idTipoCuenta`)
    REFERENCES `mydb`.`TipoCuenta` (`idTipoCuenta`))
ENGINE = InnoDB
AUTO_INCREMENT = 6
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Vigencia`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Vigencia` (
  `idVigencia` INT NOT NULL AUTO_INCREMENT,
  `fechaInicio` DATE NOT NULL,
  `fechaFin` DATE NOT NULL,
  `activo` TINYINT NOT NULL,
  PRIMARY KEY (`idVigencia`))
ENGINE = InnoDB
AUTO_INCREMENT = 2
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Descuento`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Descuento` (
  `idDescuento` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(75) NULL DEFAULT NULL,
  `esAutomatico` TINYINT NULL DEFAULT NULL,
  `activo` TINYINT NULL DEFAULT NULL,
  `idVigencia` INT NULL DEFAULT NULL,
  PRIMARY KEY (`idDescuento`),
  INDEX `idVigencia` (`idVigencia` ASC) VISIBLE,
  CONSTRAINT `Descuento_ibfk_1`
    FOREIGN KEY (`idVigencia`)
    REFERENCES `mydb`.`Vigencia` (`idVigencia`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`DescuentoLiquidacion`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`DescuentoLiquidacion` (
  `idDescuento` INT NOT NULL,
  `porcentajeLiquidacion` FLOAT NULL DEFAULT NULL,
  `condicionStockMin` INT NULL DEFAULT NULL,
  PRIMARY KEY (`idDescuento`),
  CONSTRAINT `DescuentoLiquidacion_ibfk_1`
    FOREIGN KEY (`idDescuento`)
    REFERENCES `mydb`.`Descuento` (`idDescuento`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`DescuentoMonto`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`DescuentoMonto` (
  `idDescuento` INT NOT NULL,
  `montoEditable` FLOAT NULL DEFAULT NULL,
  `montoMaximo` FLOAT NULL DEFAULT NULL,
  PRIMARY KEY (`idDescuento`),
  CONSTRAINT `DescuentoMonto_ibfk_1`
    FOREIGN KEY (`idDescuento`)
    REFERENCES `mydb`.`Descuento` (`idDescuento`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`DescuentoPorcentaje`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`DescuentoPorcentaje` (
  `idDescuento` INT NOT NULL,
  `porcentaje` FLOAT NULL DEFAULT NULL,
  PRIMARY KEY (`idDescuento`),
  CONSTRAINT `DescuentoPorcentaje_ibfk_1`
    FOREIGN KEY (`idDescuento`)
    REFERENCES `mydb`.`Descuento` (`idDescuento`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Empleado`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Empleado` (
  `idEmpleado` INT NOT NULL,
  `sueldo` DECIMAL(10,2) NULL DEFAULT NULL,
  `Cargo_idCargo` INT NOT NULL,
  `activo` TINYINT NULL DEFAULT NULL,
  PRIMARY KEY (`idEmpleado`, `Cargo_idCargo`),
  INDEX `fk_Empleado_Cargo1_idx` (`Cargo_idCargo` ASC) VISIBLE,
  CONSTRAINT `fk_Empleado_Cargo1`
    FOREIGN KEY (`Cargo_idCargo`)
    REFERENCES `mydb`.`Cargo` (`idCargo`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Factura`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Factura` (
  `idComprobante` INT NOT NULL,
  `RUC` VARCHAR(11) NULL DEFAULT NULL,
  `razonSocial` VARCHAR(110) NULL DEFAULT NULL,
  PRIMARY KEY (`idComprobante`),
  CONSTRAINT `Factura_ibfk_1`
    FOREIGN KEY (`idComprobante`)
    REFERENCES `mydb`.`ComprobanteDePago` (`idComprobante`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Falda`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Falda` (
  `idPrenda` INT NOT NULL,
  `tipo_falda` ENUM('Mini', 'Midi', 'Larga', 'Tubo', 'Plisada', 'Cruzada', 'ShortFalda', 'Otro') NOT NULL,
  `largo` DECIMAL(6,2) NOT NULL,
  `con_forro` TINYINT NOT NULL DEFAULT '0',
  `con_volantes` TINYINT NOT NULL DEFAULT '0',
  PRIMARY KEY (`idPrenda`),
  CONSTRAINT `Falda_ibfk_1`
    FOREIGN KEY (`idPrenda`)
    REFERENCES `mydb`.`Prenda` (`idPrenda`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Gorro`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Gorro` (
  `idPrenda` INT NOT NULL,
  `tipo_gorra` ENUM('Bucket', 'Visera', 'Tejido', 'Beanie', 'Otro') NOT NULL,
  `talla_ajustable` TINYINT NOT NULL DEFAULT '0',
  `impermeable` TINYINT NOT NULL DEFAULT '0',
  PRIMARY KEY (`idPrenda`),
  CONSTRAINT `Gorro_ibfk_1`
    FOREIGN KEY (`idPrenda`)
    REFERENCES `mydb`.`Prenda` (`idPrenda`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Venta`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Venta` (
  `idVenta` INT NOT NULL AUTO_INCREMENT,
  `fecha` DATETIME NOT NULL,
  `total` DECIMAL(10,2) NOT NULL,
  `Empleado_idEmpleado` INT NOT NULL,
  `Cliente_idCliente` INT NOT NULL,
  `Comprobante_idComprobante` INT NOT NULL,
  `activo` TINYINT NOT NULL DEFAULT '1',
  PRIMARY KEY (`idVenta`),
  INDEX `fk_Empleado_idEmpleado10_idx` (`Empleado_idEmpleado` ASC) VISIBLE,
  INDEX `fk_Cliente_idCliente10_idx` (`Cliente_idCliente` ASC) VISIBLE,
  INDEX `fk_Comprobante_idComprobante10_idx` (`Comprobante_idComprobante` ASC) VISIBLE,
  CONSTRAINT `fk_Cliente_idCliente10`
    FOREIGN KEY (`Cliente_idCliente`)
    REFERENCES `mydb`.`Cliente` (`idCliente`),
  CONSTRAINT `fk_Comprobante_idComprobante10`
    FOREIGN KEY (`Comprobante_idComprobante`)
    REFERENCES `mydb`.`ComprobanteDePago` (`idComprobante`),
  CONSTRAINT `fk_Empleado_idEmpleado10`
    FOREIGN KEY (`Empleado_idEmpleado`)
    REFERENCES `mydb`.`Empleado` (`idEmpleado`))
ENGINE = InnoDB
AUTO_INCREMENT = 8
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `mydb`.`ItemVenta`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ItemVenta` (
  `numLinea` INT NOT NULL AUTO_INCREMENT,
  `Prenda_idPrenda` INT NOT NULL,
  `cantidad` INT NOT NULL,
  `subtotal` DECIMAL(10,2) NOT NULL,
  `Venta_idVenta` INT NOT NULL,
  `activo` TINYINT NOT NULL DEFAULT '1',
  PRIMARY KEY (`numLinea`),
  INDEX `fk_Prenda_idPrenda1_idx` (`Prenda_idPrenda` ASC) VISIBLE,
  INDEX `fk_Venta_idVenta1_idx` (`Venta_idVenta` ASC) VISIBLE,
  CONSTRAINT `fk_Prenda_idPrenda1`
    FOREIGN KEY (`Prenda_idPrenda`)
    REFERENCES `mydb`.`Prenda` (`idPrenda`),
  CONSTRAINT `fk_Venta_idVenta1`
    FOREIGN KEY (`Venta_idVenta`)
    REFERENCES `mydb`.`Venta` (`idVenta`))
ENGINE = InnoDB
AUTO_INCREMENT = 12
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `mydb`.`Lote`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Lote` (
  `idLote` INT NOT NULL AUTO_INCREMENT,
  `Almacen_idAlmacen` INT NOT NULL,
  `activo` TINYINT NOT NULL,
  `descripcion` VARCHAR(255) NULL DEFAULT NULL,
  PRIMARY KEY (`idLote`),
  INDEX `fk_Lote_Almacen1_idx` (`Almacen_idAlmacen` ASC) VISIBLE,
  CONSTRAINT `fk_Lote_Almacen1`
    FOREIGN KEY (`Almacen_idAlmacen`)
    REFERENCES `mydb`.`Almacen` (`idAlmacen`))
ENGINE = InnoDB
AUTO_INCREMENT = 42
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`OrdenCompra`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`OrdenCompra` (
  `idCompra` INT NOT NULL AUTO_INCREMENT,
  `fechaLlegada` DATETIME NOT NULL,
  `fechaEmision` DATETIME NOT NULL,
  `deudaPendiente` DECIMAL(10,2) NOT NULL,
  `montoTotal` DECIMAL(10,2) NOT NULL,
  `Proveedor_idProveedor` INT NOT NULL,
  `Empleado_idEmpleado` INT NOT NULL,
  `activo` TINYINT NOT NULL DEFAULT '1',
  PRIMARY KEY (`idCompra`),
  INDEX `fk_Empleado_idEmpleado11_idx` (`Empleado_idEmpleado` ASC) VISIBLE,
  INDEX `fk_Proveedor_idProveedor2_idx` (`Proveedor_idProveedor` ASC) VISIBLE,
  CONSTRAINT `fk_Empleado_idEmpleado11`
    FOREIGN KEY (`Empleado_idEmpleado`)
    REFERENCES `mydb`.`Empleado` (`idEmpleado`),
  CONSTRAINT `fk_Proveedor_idProveedor2`
    FOREIGN KEY (`Proveedor_idProveedor`)
    REFERENCES `mydb`.`Proveedor` (`idProveedor`))
ENGINE = InnoDB
AUTO_INCREMENT = 5
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `mydb`.`LineaLoteCompra`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`LineaLoteCompra` (
  `idPrenda` INT NOT NULL,
  `numLinea` INT NOT NULL AUTO_INCREMENT,
  `cantidad` INT NOT NULL DEFAULT '0',
  `talla` ENUM('XS', 'S', 'M', 'L', 'XL', 'XXL') NULL DEFAULT NULL,
  `lote_idLote` INT NOT NULL,
  `precioLote` DECIMAL(10,2) NOT NULL,
  `OrdenCompra_idCompra` INT NOT NULL,
  `activo` TINYINT NOT NULL DEFAULT '1',
  PRIMARY KEY (`numLinea`),
  INDEX `fk_lote_idLote1_idx` (`lote_idLote` ASC) VISIBLE,
  INDEX `fk_OrdenCompra_idCompra1_idx` (`OrdenCompra_idCompra` ASC) VISIBLE,
  CONSTRAINT `fk_lote_idLote1`
    FOREIGN KEY (`lote_idLote`)
    REFERENCES `mydb`.`Lote` (`idLote`),
  CONSTRAINT `fk_OrdenCompra_idCompra1`
    FOREIGN KEY (`OrdenCompra_idCompra`)
    REFERENCES `mydb`.`OrdenCompra` (`idCompra`))
ENGINE = InnoDB
AUTO_INCREMENT = 9
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `mydb`.`MovimientoAlmacen`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`MovimientoAlmacen` (
  `idMovAlmacen` INT NOT NULL AUTO_INCREMENT,
  `Almacen_idAlmacen` INT NOT NULL,
  `fecha` DATETIME NOT NULL,
  `lugarDestino` VARCHAR(100) NOT NULL,
  `lugarOrigen` VARCHAR(100) NOT NULL,
  `tipo` VARCHAR(50) NOT NULL,
  `activo` TINYINT NOT NULL,
  PRIMARY KEY (`idMovAlmacen`, `Almacen_idAlmacen`),
  INDEX `fk_MovimientoAlmacen_Almacen1_idx` (`Almacen_idAlmacen` ASC) VISIBLE,
  CONSTRAINT `fk_MovimientoAlmacen_Almacen1`
    FOREIGN KEY (`Almacen_idAlmacen`)
    REFERENCES `mydb`.`Almacen` (`idAlmacen`))
ENGINE = InnoDB
AUTO_INCREMENT = 42
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`MovimientoAlmacen_X_Lote`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`MovimientoAlmacen_X_Lote` (
  `idMovAlmacen_X_Lote` INT NOT NULL AUTO_INCREMENT,
  `Lote_idLote` INT NOT NULL,
  `MovimientoAlmacen_idMovAlmacen` INT NOT NULL,
  `MovimientoAlmacen_Almacen_idAlmacen` INT NOT NULL,
  `activo` TINYINT NOT NULL,
  PRIMARY KEY (`idMovAlmacen_X_Lote`),
  INDEX `fk_Lote_has_MovimientoAlmacen_MovimientoAlmacen1_idx` (`MovimientoAlmacen_idMovAlmacen` ASC, `MovimientoAlmacen_Almacen_idAlmacen` ASC) VISIBLE,
  INDEX `fk_Lote_has_MovimientoAlmacen_Lote1_idx` (`Lote_idLote` ASC) VISIBLE,
  CONSTRAINT `fk_Lote_has_MovimientoAlmacen_Lote1`
    FOREIGN KEY (`Lote_idLote`)
    REFERENCES `mydb`.`Lote` (`idLote`),
  CONSTRAINT `fk_Lote_has_MovimientoAlmacen_MovimientoAlmacen1`
    FOREIGN KEY (`MovimientoAlmacen_idMovAlmacen` , `MovimientoAlmacen_Almacen_idAlmacen`)
    REFERENCES `mydb`.`MovimientoAlmacen` (`idMovAlmacen` , `Almacen_idAlmacen`))
ENGINE = InnoDB
AUTO_INCREMENT = 43
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`NotaDeCredito`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`NotaDeCredito` (
  `idComprobante` INT NOT NULL,
  `detalleModificacion` VARCHAR(255) NULL DEFAULT NULL,
  `RUC` VARCHAR(11) NULL DEFAULT NULL,
  `razonSocial` VARCHAR(45) NULL DEFAULT NULL,
  `DNI` VARCHAR(8) NULL DEFAULT NULL,
  `motivoEspecifico` VARCHAR(255) NULL DEFAULT NULL,
  `nuevoMonto` DOUBLE NULL DEFAULT NULL,
  `valorAumentar` DOUBLE NULL DEFAULT NULL,
  PRIMARY KEY (`idComprobante`),
  CONSTRAINT `NotaDeCredito_ibfk_1`
    FOREIGN KEY (`idComprobante`)
    REFERENCES `mydb`.`ComprobanteDePago` (`idComprobante`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`NotaDeDebito`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`NotaDeDebito` (
  `idComprobante` INT NOT NULL,
  `detalleModificacion` VARCHAR(255) NULL DEFAULT NULL,
  `RUC` VARCHAR(11) NULL DEFAULT NULL,
  `razonSocial` VARCHAR(45) NULL DEFAULT NULL,
  `motivoEspecifico` VARCHAR(45) NULL DEFAULT NULL,
  `nuevoMonto` DOUBLE NULL DEFAULT NULL,
  `valorAumentar` DOUBLE NULL DEFAULT NULL,
  `idPrenda` INT NULL DEFAULT NULL,
  PRIMARY KEY (`idComprobante`),
  INDEX `idPrenda` (`idPrenda` ASC) VISIBLE,
  CONSTRAINT `NotaDeDebito_ibfk_1`
    FOREIGN KEY (`idComprobante`)
    REFERENCES `mydb`.`ComprobanteDePago` (`idComprobante`),
  CONSTRAINT `NotaDeDebito_ibfk_2`
    FOREIGN KEY (`idPrenda`)
    REFERENCES `mydb`.`Prenda` (`idPrenda`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Pantalon`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Pantalon` (
  `idPrenda` INT NOT NULL,
  `tipo_pantalon` ENUM('Jean', 'Jogger', 'Chino', 'Cargo', 'Buzo', 'Leggins', 'Palazzo', 'Otro') NOT NULL,
  `largo_pierna` DECIMAL(6,2) NOT NULL,
  `cintura` DECIMAL(6,2) NOT NULL,
  `elasticidad` TINYINT NOT NULL DEFAULT '0',
  PRIMARY KEY (`idPrenda`),
  CONSTRAINT `Pantalon_ibfk_1`
    FOREIGN KEY (`idPrenda`)
    REFERENCES `mydb`.`Prenda` (`idPrenda`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Polo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Polo` (
  `idPrenda` INT NOT NULL AUTO_INCREMENT,
  `tipo_manga` ENUM('MangaCorta', 'MangaLarga', 'SinManga', 'Globo', 'Campana', 'TresCuartos') NOT NULL,
  `estampado` VARCHAR(80) NULL DEFAULT NULL,
  `tipo_cuello` ENUM('Redondo', 'V', 'Camisero', 'Alto', 'Halter', 'OffShoulder', 'Otro') NOT NULL,
  PRIMARY KEY (`idPrenda`),
  CONSTRAINT `Polo_ibfk_1`
    FOREIGN KEY (`idPrenda`)
    REFERENCES `mydb`.`Prenda` (`idPrenda`))
ENGINE = InnoDB
AUTO_INCREMENT = 45
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`PrendaDescuento`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`PrendaDescuento` (
  `idPrenda` INT NOT NULL,
  `idDescuento` INT NOT NULL,
  `activo` TINYINT NULL DEFAULT NULL,
  PRIMARY KEY (`idPrenda`, `idDescuento`),
  INDEX `idDescuento` (`idDescuento` ASC) VISIBLE,
  CONSTRAINT `PrendaDescuento_ibfk_1`
    FOREIGN KEY (`idPrenda`)
    REFERENCES `mydb`.`Prenda` (`idPrenda`),
  CONSTRAINT `PrendaDescuento_ibfk_2`
    FOREIGN KEY (`idDescuento`)
    REFERENCES `mydb`.`Descuento` (`idDescuento`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`PrendaLote`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`PrendaLote` (
  `idPrendaLote` INT NOT NULL AUTO_INCREMENT,
  `Prenda_idPrenda` INT NOT NULL,
  `Lote_idLote` INT NOT NULL,
  `Lote_MovimientoAlmacen_idMovAlmacen` INT NOT NULL,
  `Lote_MovimientoAlmacen_Almacen_idAlmacen` INT NOT NULL,
  `stock` INT NOT NULL,
  `activo` TINYINT NOT NULL DEFAULT '1',
  `talla` ENUM('XS', 'S', 'M', 'L', 'XL', 'XXL') NOT NULL,
  PRIMARY KEY (`idPrendaLote`, `Prenda_idPrenda`, `Lote_idLote`, `Lote_MovimientoAlmacen_idMovAlmacen`, `Lote_MovimientoAlmacen_Almacen_idAlmacen`),
  UNIQUE INDEX `idPrendaLote_UNIQUE` (`idPrendaLote` ASC) VISIBLE,
  INDEX `fk_Prenda_has_Lote_Lote1_idx` (`Lote_idLote` ASC, `Lote_MovimientoAlmacen_idMovAlmacen` ASC, `Lote_MovimientoAlmacen_Almacen_idAlmacen` ASC) VISIBLE,
  INDEX `fk_Prenda_has_Lote_Prenda1_idx` (`Prenda_idPrenda` ASC) VISIBLE,
  CONSTRAINT `fk_Prenda_has_Lote_Lote1`
    FOREIGN KEY (`Lote_idLote`)
    REFERENCES `mydb`.`Lote` (`idLote`),
  CONSTRAINT `fk_Prenda_has_Lote_Prenda1`
    FOREIGN KEY (`Prenda_idPrenda`)
    REFERENCES `mydb`.`Prenda` (`idPrenda`))
ENGINE = InnoDB
AUTO_INCREMENT = 3
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Promocion`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Promocion` (
  `idPromocion` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(75) NULL DEFAULT NULL,
  `esAutomatico` TINYINT NULL DEFAULT NULL,
  `activo` TINYINT NULL DEFAULT NULL,
  `idVigencia` INT NULL DEFAULT NULL,
  PRIMARY KEY (`idPromocion`),
  INDEX `idVigencia` (`idVigencia` ASC) VISIBLE,
  CONSTRAINT `Promocion_ibfk_1`
    FOREIGN KEY (`idVigencia`)
    REFERENCES `mydb`.`Vigencia` (`idVigencia`))
ENGINE = InnoDB
AUTO_INCREMENT = 2
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`PrendaPromocion`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`PrendaPromocion` (
  `idPrenda` INT NOT NULL,
  `idPromocion` INT NOT NULL,
  `activo` TINYINT NULL DEFAULT NULL,
  PRIMARY KEY (`idPrenda`, `idPromocion`),
  INDEX `idPromocion` (`idPromocion` ASC) VISIBLE,
  CONSTRAINT `PrendaPromocion_ibfk_1`
    FOREIGN KEY (`idPrenda`)
    REFERENCES `mydb`.`Prenda` (`idPrenda`),
  CONSTRAINT `PrendaPromocion_ibfk_2`
    FOREIGN KEY (`idPromocion`)
    REFERENCES `mydb`.`Promocion` (`idPromocion`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`PromocionCombo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`PromocionCombo` (
  `idPromocion` INT NOT NULL AUTO_INCREMENT,
  `cantidadRequerida` INT NULL DEFAULT NULL,
  `cantidadGratis` INT NULL DEFAULT NULL,
  PRIMARY KEY (`idPromocion`),
  CONSTRAINT `PromocionCombo_ibfk_1`
    FOREIGN KEY (`idPromocion`)
    REFERENCES `mydb`.`Promocion` (`idPromocion`))
ENGINE = InnoDB
AUTO_INCREMENT = 2
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`PromocionConjunto`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`PromocionConjunto` (
  `idPromocion` INT NOT NULL AUTO_INCREMENT,
  `porcentajePromocion` FLOAT NULL DEFAULT NULL,
  PRIMARY KEY (`idPromocion`),
  CONSTRAINT `PromocionConjunto_ibfk_1`
    FOREIGN KEY (`idPromocion`)
    REFERENCES `mydb`.`Promocion` (`idPromocion`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`Vestido`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Vestido` (
  `idPrenda` INT NOT NULL,
  `tipo_vestido` ENUM('Coctel', 'Fiesta', 'Gala', 'Playa', 'Ejecutivo', 'Maxi', 'Mini', 'Casual') NOT NULL,
  `largo` INT NOT NULL,
  `tipo_manga` ENUM('MangaCorta', 'MangaLarga', 'SinManga', 'Globo', 'Campana', 'TresCuartos') NOT NULL,
  PRIMARY KEY (`idPrenda`),
  CONSTRAINT `Vestido_ibfk_1`
    FOREIGN KEY (`idPrenda`)
    REFERENCES `mydb`.`Prenda` (`idPrenda`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;

USE `mydb` ;

-- -----------------------------------------------------
-- procedure eliminar_almacen
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_almacen`(
	_idAlmacen int
)
BEGIN 
	UPDATE Almacen
    SET activo=0 
    WHERE idAlmacen=_idAlmacen;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_blusa
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_blusa`(
    IN _idPrenda INT
)
BEGIN
  UPDATE Prenda
     SET activo = 0
   WHERE idPrenda = _idPrenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_boleta
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_boleta`(
    IN _id_Comprobante INT
)
BEGIN
    UPDATE ComprobanteDePago
       SET activa = 0
     WHERE idComprobante = _id_Comprobante;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_cargo
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_cargo`(
	IN _idCargo INT
)
BEGIN
	UPDATE Cargo SET activo = 0
    WHERE idCargo=_idCargo;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_casaca
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_casaca`(
    IN _idPrenda INT
)
BEGIN
  UPDATE Prenda
     SET activo = 0
   WHERE idPrenda = _idPrenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_cliente
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_cliente`(
	IN _idCliente INT)
BEGIN
  
  UPDATE Cliente SET activo=0
  WHERE idCliente=_idCliente;
 
  
  
  END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_cuentaUsuario
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_cuentaUsuario`(
	IN _idCuenta INT
)
BEGIN
	UPDATE CuentaUsuario SET activo = 0
    WHERE idCuenta=_idCuenta;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_descuentoLiquidacion
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_descuentoLiquidacion`(in id int)
BEGIN
		update Descuento 
        set activo=0
        where idDescuento=id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_descuentoMonto
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_descuentoMonto`(in id int)
BEGIN
		update Descuento 
        set activo=0
        where idDescuento=id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_descuentoPorcentaje
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_descuentoPorcentaje`(in id int)
BEGIN
		update Descuento 
        set activo=0
        where idDescuento=id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_empleado
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_empleado`(
	IN _idEmpleado INT
)
BEGIN
	UPDATE Empleado SET activo = 0
    WHERE idEmpleado=_idEmpleado;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_factura
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_factura`(
    IN _id_Comprobante INT
)
BEGIN
    UPDATE ComprobanteDePago
       SET activa = 0
     WHERE idComprobante = _id_Comprobante;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_falda
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_falda`(
		IN _idPrenda INT )
BEGIN
  UPDATE Prenda SET activo=0
  WHERE idPrenda=_idPrenda;
  END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_gorro
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_gorro`(
    IN _idPrenda INT
)
BEGIN
  UPDATE Prenda
     SET activo = 0
   WHERE idPrenda = _idPrenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_lote
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_lote`(
	_idLote int
)
BEGIN
	UPDATE Lote SET activo=0
	WHERE idLote=_idLote;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_mov_X_lote
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_mov_X_lote`(
	_idMovAlmacen_X_Lote int
)
BEGIN
    UPDATE MovimientoAlmacen_X_Lote SET activo=0
	WHERE idMovAlmacen_X_Lote=_idMovAlmacen_X_Lote;
    
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_mov_almacen
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_mov_almacen`(
	_idMovAlmacen INT
)
BEGIN
	UPDATE MovimientoAlmacen
    SET activo=0
    WHERE idMovAlmacen=_idMovAlmacen;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_nota_de_credito
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_nota_de_credito`(
    IN _id_Comprobante INT
)
BEGIN
    UPDATE ComprobanteDePago
       SET activa = 0
     WHERE idComprobante = _id_Comprobante;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_nota_de_debito
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_nota_de_debito`(
    IN _id_Comprobante INT
)
BEGIN
    UPDATE ComprobanteDePago
       SET activa = 0
     WHERE idComprobante = _id_Comprobante;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_orden_compra
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_orden_compra`(
	IN _idCompra INT
)
BEGIN
	UPDATE OrdenCompra SET activo = 0 
    WHERE idCompra = _idCompra ;
    
    UPDATE LineaLoteCompra 
    SET activo = 0 
    WHERE OrdenCompra_idCompra = _idCompra;
    
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_pantalon
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_pantalon`(
    IN _idPrenda INT
)
BEGIN
  UPDATE Prenda
     SET activo = 0
   WHERE idPrenda = _idPrenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_polo
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_polo`(
    IN _id_prenda INT
)
BEGIN
  UPDATE Prenda
     SET activo = 0
   WHERE idPrenda = _id_prenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_prenda_lote
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_prenda_lote`(
    IN _id_prenda_lote INT
)
BEGIN
  UPDATE PrendaLote
     SET activo = 0
   WHERE idPrendaLote = _id_prenda_lote;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_prendadescuento
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_prendadescuento`(in indP int, in indDesc int)
begin
update PrendaDescuento
    set activo=0
    where idPrenda=indP and idDescuento=indDesc;    
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_prendapromocion
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_prendapromocion`(in indP int, in indPro int)
begin
    update PrendaPromocion
    set activo=0
    where idPrenda=indP and idPromocion=indPro;
    
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_promocioncombo
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_promocioncombo`(in id int)
BEGIN
		update Promocion 
        set activo=0
        where idPromocion=id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_promocionconjunto
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_promocionconjunto`(in id int)
BEGIN
		update Promocion 
        set activo=0
        where idPromocion=id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_proveedor
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_proveedor`(
		IN _idProveedor INT )
BEGIN
  UPDATE Proveedor SET activo=0
  WHERE idProveedor=_idProveedor;
  
  
  UPDATE CondicionPago
    SET vigente = 0
    WHERE Proveedor_idProveedor = _idProveedor ;
  
  
  END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_tipoCuenta
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_tipoCuenta`(
	IN _idTipoCuenta INT
)
BEGIN
	UPDATE TipoCuenta SET activo = 0
    WHERE idTipoCuenta=_idTipoCuenta;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_venta
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_venta`(
	IN _idVenta INT
)
BEGIN
	UPDATE Venta SET activo = 0 
    WHERE idVenta = _idVenta ;
    
    UPDATE ItemVenta 
    SET activo = 0 
    WHERE Venta_idVenta = _idVenta;
    
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_vestido
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_vestido`(
    IN _idPrenda INT
)
BEGIN
  UPDATE Prenda
     SET activo = 0
   WHERE idPrenda = _idPrenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure eliminar_vigencia
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `eliminar_vigencia`(in id int)
BEGIN
		update Vigencia 
        set activo=0
        where idVigencia=id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure filtrar_blusas
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `filtrar_blusas`(
    IN _nombre_like      VARCHAR(100),
    IN _color_like       VARCHAR(30),
    IN _material_like    VARCHAR(50),
    IN _tipo_blusa_like  VARCHAR(30),
    IN _tipo_manga_like  VARCHAR(30),
    IN _precio_min       DECIMAL(10,2),
    IN _precio_max       DECIMAL(10,2),
    IN _solo_activos     TINYINT
)
BEGIN
  SELECT 
      p.*,
      b.tipo_blusa,
      b.tipo_manga
  FROM Prenda p
  JOIN Blusa b ON b.idPrenda = p.idPrenda
  WHERE
      (_nombre_like     IS NULL OR p.nombre   LIKE CONCAT('%', _nombre_like, '%'))
    AND
      (_color_like      IS NULL OR p.color    LIKE CONCAT('%', _color_like, '%'))
    AND
      (_material_like   IS NULL OR p.material LIKE  _material_like)
    AND
      (_tipo_blusa_like IS NULL OR b.tipo_blusa LIKE _tipo_blusa_like)
    AND
      (_tipo_manga_like IS NULL OR b.tipo_manga LIKE _tipo_manga_like)
    AND
      (_precio_min      IS NULL OR p.precioUnidad >= _precio_min)
    AND
      (_precio_max      IS NULL OR p.precioUnidad <= _precio_max)
    AND
      (_solo_activos    IS NULL OR p.activo = _solo_activos);
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure filtrar_casacas
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `filtrar_casacas`(
    IN _nombre_like       VARCHAR(100),
    IN _color_like        VARCHAR(30),
    IN _material          VARCHAR(50),   -- ENUM: igualdad
    IN _tipo_casaca       VARCHAR(30),   -- ENUM: igualdad
    IN _con_capucha       TINYINT,       -- NULL no filtra; 1 sí; 0 no
    IN _precio_min        DECIMAL(10,2),
    IN _precio_max        DECIMAL(10,2),
    IN _solo_activos      TINYINT
)
BEGIN
  SELECT
      p.*,
      c.tipo_casaca,
      c.con_capucha
  FROM Prenda p
  JOIN Casaca c ON c.idPrenda = p.idPrenda
  WHERE
      (_nombre_like   IS NULL OR p.nombre      LIKE CONCAT('%', _nombre_like, '%'))
    AND
      (_color_like    IS NULL OR p.color       LIKE CONCAT('%', _color_like,  '%'))
    AND
      (_material      IS NULL OR p.material     = _material)
    AND
      (_tipo_casaca   IS NULL OR c.tipo_casaca  = _tipo_casaca)
    AND
      (_con_capucha   IS NULL OR c.con_capucha  = _con_capucha)
    AND
      (_precio_min    IS NULL OR p.precioUnidad >= _precio_min)
    AND
      (_precio_max    IS NULL OR p.precioUnidad <= _precio_max)
    AND
      (_solo_activos  IS NULL OR p.activo = _solo_activos);
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure filtrar_faldas
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `filtrar_faldas`(
    IN _nombre_like      VARCHAR(100),
    IN _color_like       VARCHAR(30),
    IN _material         VARCHAR(50),    -- ENUM: igualdad
    IN _tipo_falda       VARCHAR(30),    -- ENUM: igualdad
    IN _con_forro        TINYINT,        -- NULL no filtra; 1 sí; 0 no
    IN _con_volantes     TINYINT,        -- NULL no filtra; 1 sí; 0 no
    IN _precio_min       DECIMAL(10,2),
    IN _precio_max       DECIMAL(10,2),
    IN _largo_min        DECIMAL(10,2),
    IN _largo_max        DECIMAL(10,2),
    IN _solo_activos     TINYINT         -- NULL no filtra; 1 activos; 0 inactivos
)
BEGIN
  SELECT
      p.*,
      f.tipo_falda,
      f.largo,
      f.con_forro,
      f.con_volantes
  FROM Prenda p
  JOIN Falda f ON f.idPrenda = p.idPrenda
  WHERE
      (_nombre_like  IS NULL OR p.nombre LIKE CONCAT('%', _nombre_like, '%'))
    AND
      (_color_like   IS NULL OR p.color  LIKE CONCAT('%', _color_like,  '%'))
    AND
      (_material     IS NULL OR p.material    = _material)
    AND
      (_tipo_falda   IS NULL OR f.tipo_falda  = _tipo_falda)
    AND
      (_con_forro    IS NULL OR f.con_forro   = _con_forro)
    AND
      (_con_volantes IS NULL OR f.con_volantes = _con_volantes)
    AND
      (_precio_min   IS NULL OR p.precioUnidad >= _precio_min)
    AND
      (_precio_max   IS NULL OR p.precioUnidad <= _precio_max)
    AND
      (_largo_min    IS NULL OR f.largo >= _largo_min)
    AND
      (_largo_max    IS NULL OR f.largo <= _largo_max)
    AND
      (_solo_activos IS NULL OR p.activo = _solo_activos);
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure filtrar_pantalones
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `filtrar_pantalones`(
    IN _nombre_like        VARCHAR(100),
    IN _color_like         VARCHAR(30),
    IN _material           VARCHAR(50),   -- ENUM: igualdad
    IN _tipo_pantalon      VARCHAR(30),   -- ENUM: igualdad
    IN _elasticidad        TINYINT,       -- NULL: no filtra; 1: elásticos; 0: no elásticos
    IN _precio_min         DECIMAL(10,2),
    IN _precio_max         DECIMAL(10,2),
    IN _largo_min          DECIMAL(10,2),
    IN _largo_max          DECIMAL(10,2),
    IN _cintura_min        DECIMAL(10,2),
    IN _cintura_max        DECIMAL(10,2),
    IN _solo_activos       TINYINT        -- NULL no filtra; 1 activos; 0 inactivos
)
BEGIN
  SELECT
      p.*,
      pa.tipo_pantalon,
      pa.largo_pierna,
      pa.cintura,
      pa.elasticidad
  FROM Prenda p
  JOIN Pantalon pa ON pa.idPrenda = p.idPrenda
  WHERE
      (_nombre_like   IS NULL OR p.nombre       LIKE CONCAT('%', _nombre_like, '%'))
    AND
      (_color_like    IS NULL OR p.color        LIKE CONCAT('%', _color_like,  '%'))
    AND
      (_material      IS NULL OR p.material      = _material)
    AND
      (_tipo_pantalon IS NULL OR pa.tipo_pantalon = _tipo_pantalon)
    AND
      (_elasticidad   IS NULL OR pa.elasticidad   = _elasticidad)
    AND
      (_precio_min    IS NULL OR p.precioUnidad   >= _precio_min)
    AND
      (_precio_max    IS NULL OR p.precioUnidad   <= _precio_max)
    AND
      (_largo_min     IS NULL OR pa.largo_pierna  >= _largo_min)
    AND
      (_largo_max     IS NULL OR pa.largo_pierna  <= _largo_max)
    AND
      (_cintura_min   IS NULL OR pa.cintura       >= _cintura_min)
    AND
      (_cintura_max   IS NULL OR pa.cintura       <= _cintura_max)
    AND
      (_solo_activos  IS NULL OR p.activo         = _solo_activos);
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure filtrar_polos
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `filtrar_polos`(
    IN _nombre_like       VARCHAR(100),
    IN _color_like        VARCHAR(30),
    IN _material          VARCHAR(50),
    IN _tipo_cuello       VARCHAR(30),
    IN _tipo_manga        VARCHAR(30),
    IN _precio_min        DECIMAL(10,2),
    IN _precio_max        DECIMAL(10,2),
    IN _solo_activos      TINYINT
)
BEGIN
  SELECT 
      p.*,
      po.tipo_manga,
      po.estampado,
      po.tipo_cuello
  FROM Prenda p
  JOIN Polo po ON po.idPrenda = p.idPrenda
  WHERE
      (_nombre_like IS NULL OR p.nombre LIKE CONCAT('%', _nombre_like, '%'))
    AND
      (_color_like IS NULL OR p.color LIKE CONCAT('%', _color_like, '%'))
    AND
      (_material IS NULL OR p.material = _material)
    AND
      (_tipo_cuello IS NULL OR po.tipo_cuello = _tipo_cuello)
    AND
      (_tipo_manga IS NULL OR po.tipo_manga = _tipo_manga)
    AND
      (_precio_min IS NULL OR p.precioUnidad >= _precio_min)
    AND
      (_precio_max IS NULL OR p.precioUnidad <= _precio_max)
    AND
      (_solo_activos IS NULL OR p.activo = _solo_activos);
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure filtrar_vestidos
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `filtrar_vestidos`(
    IN _nombre_like       VARCHAR(100),
    IN _color_like        VARCHAR(30),
    IN _material          VARCHAR(50),   -- ENUM: igualdad
    IN _tipo_vestido      VARCHAR(30),   -- ENUM: igualdad
    IN _tipo_manga        VARCHAR(30),   -- ENUM: igualdad
    IN _precio_min        DECIMAL(10,2),
    IN _precio_max        DECIMAL(10,2),
    IN _solo_activos      TINYINT
)
BEGIN
  SELECT
      p.*,
      v.tipo_vestido,
      v.tipo_manga,
      v.largo
  FROM Prenda p
  JOIN Vestido v ON v.idPrenda = p.idPrenda
  WHERE
      (_nombre_like  IS NULL OR p.nombre      LIKE CONCAT('%', _nombre_like, '%'))
    AND
      (_color_like   IS NULL OR p.color       LIKE CONCAT('%', _color_like,  '%'))
    AND
      (_material     IS NULL OR p.material     = _material)
    AND
      (_tipo_vestido IS NULL OR v.tipo_vestido = _tipo_vestido)
    AND
      (_tipo_manga   IS NULL OR v.tipo_manga   = _tipo_manga)
    AND
      (_precio_min   IS NULL OR p.precioUnidad >= _precio_min)
    AND
      (_precio_max   IS NULL OR p.precioUnidad <= _precio_max)
    AND
      (_solo_activos IS NULL OR p.activo = _solo_activos);
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_Item_Venta
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_Item_Venta`(
	OUT _numLinea INT,
    IN _Prenda_idPrenda INT,
    IN _cantidad INT,
    IN _subtotal decimal(10,2),
    IN _Venta_idVenta INT
)
BEGIN

	INSERT INTO ItemVenta (Prenda_idPrenda,
    cantidad,subtotal,Venta_idVenta, activo)
    VALUES (_Prenda_idPrenda,_cantidad,
    _subtotal,_Venta_idVenta,  1);

    SET _numLinea = @@last_insert_id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_Item__orden_Compra
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_Item__orden_Compra`(
	OUT _numLinea INT,
    IN _idPrenda INT,
    IN _cantidad INT,
    IN _talla varchar(20),
    IN _lote_idLote INT,
    IN _precioLote decimal(10,2),
    IN _OrdenCompra_idCompra INT,
    IN _activo tinyint
)
BEGIN
	
	INSERT INTO LineaLoteCompra (idPrenda,
    cantidad,talla,lote_idLote,
    precioLote,OrdenCompra_idCompra,
    activo)
    VALUES (_idPrenda , _cantidad,
    _talla,_lote_idLote,
    _precioLote,_OrdenCompra_idCompra, 1 );

    SET _numLinea = @@last_insert_id; 
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_almacen
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_almacen`(
	OUT _id_almacen INT,
    IN _nombre varchar(70),
    IN _ubicacion varchar(70),
    IN _stock int,
    IN _Tienda_idTienda int
)
BEGIN
	INSERT INTO Almacen(nombre, ubicacion, stock, Activo, Tienda_idTienda)
    VALUES (_nombre, _ubicacion, _stock, 1,_Tienda_idTienda);
    SET _id_almacen = @@last_insert_id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_blusa
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_blusa`(
    OUT _id_prenda INT,
    IN  _nombre VARCHAR(100),
    IN  _precioUnidad DECIMAL(10,2),
    IN  _precioMayor  DECIMAL(10,2),
    IN  _precioDocena DECIMAL(10,2),
    IN  _alertaMinStock INT,
    IN  _color VARCHAR(30),
    IN  _material ENUM('Algodon','Poliester','Mezcla_algodon_poliester','Lino','Viscosa_rayon',
                       'Lana','Acrilico','Nylon','Elastano_lycra','Denim','Drill','Gabardina',
                       'Polar','Franela','Cuero','Cuerina','Saten','Chifon'),
    IN  _tipo_blusa ENUM('Camisera','CropTop','Peplum','OffShoulder','Transparente','Formal','Casual'),
    IN  _tipo_manga ENUM('MangaCorta','MangaLarga','SinManga','Globo','Campana','TresCuartos')
)
BEGIN
    INSERT INTO Prenda(nombre, activo, precioUnidad, precioMayor, precioDocena,
                       alertaMinStock, color, material)
    VALUES(_nombre, 1, _precioUnidad, _precioMayor, _precioDocena,
           _alertaMinStock, _color, _material);

    SET _id_prenda = LAST_INSERT_ID();

    INSERT INTO Blusa(idPrenda, tipo_blusa, tipo_manga)
    VALUES(_id_prenda, _tipo_blusa, _tipo_manga);
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_boleta
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_boleta`(
	OUT _id_Comprobante INT,
	IN _FECHA DATETIME,
    IN _TOTAL DOUBLE,
    IN _IGV   DOUBLE,
    IN _METODOPAGO VARCHAR(45),
    IN _CORRELATIVO VARCHAR(45),
    IN _DNI VARCHAR(8)
)
BEGIN	
	INSERT INTO ComprobanteDePago(
    fecha,total,IGV,metodoDePago,correlativo,activa)
    VALUES (_FECHA,_TOTAL,_IGV,_METODOPAGO,_CORRELATIVO,1);
    SET _id_Comprobante = @@last_insert_id;
	INSERT INTO Boleta(idComprobante,DNI)
    VALUES (_id_Comprobante,_DNI);
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_cargo
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_cargo`(
	OUT _idCargo INT,
    IN _abreviatura CHAR,
    IN _descripcion VARCHAR(75)
)
BEGIN
	INSERT INTO Cargo (abreviatura,descripcion,activo) VALUES (
		_abreviatura,_descripcion,1);
	SET _idCargo = @@last_insert_id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_casaca
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_casaca`(
	OUT  _id_prenda INT,
    IN  _nombre VARCHAR(100),
    IN  _precioUnidad DECIMAL(10,2),
    IN  _precioMayor  DECIMAL(10,2),
    IN  _precioDocena DECIMAL(10,2),
    IN  _alertaMinStock INT,
    IN  _color VARCHAR(30),
    IN  _material ENUM('Algodon','Poliester','Mezcla_algodon_poliester','Lino','Viscosa_rayon',
                       'Lana','Acrilico','Nylon','Elastano_lycra','Denim','Drill','Gabardina',
                       'Polar','Franela','Cuero','Cuerina','Saten','Chifon'),
    IN  _tipo_casaca  ENUM('Bomber','Puffer','Denim','Deportiva','Cuero','Cardigan','Otro'),
    IN  _con_capucha TINYINT    
)
BEGIN
	INSERT INTO Prenda(nombre, activo, precioUnidad, precioMayor, precioDocena,
                       alertaMinStock, color, material)
    VALUES(_nombre, 1, _precioUnidad, _precioMayor, _precioDocena,
           _alertaMinStock, _color, _material);

    SET _id_prenda = @@last_insert_id;

    INSERT INTO Casaca(idPrenda, tipo_casaca, con_capucha)
    VALUES(_id_prenda, _tipo_casaca, _con_capucha);

END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_cliente
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_cliente`(  OUT _idCliente INT,     
IN _nombre VARCHAR(75),     IN _primerApellido VARCHAR(75),   
  IN _segundoApellido VARCHAR(75),     IN _dni INT,
  IN _telefono INT, IN _genero CHAR , IN _abreviatura CHAR(1),
  IN _descripcion VARCHAR(120), IN _tipoCliente INT
  )
BEGIN  
  
  INSERT INTO Persona(nombre, primerApellido,segundoApellido,
  dni,telefono, genero) 
  VALUES (_nombre, _primerApellido, _segundoApellido, _dni ,
   _telefono  , _genero);  

  SET _idCliente = @@last_insert_id;
  
  
  INSERT INTO TipoDeCliente(tipoCliente,abreviatura, descripcion) 
  VALUES (_tipoCliente,_abreviatura, _descripcion);  
  
  INSERT INTO Cliente(idCliente,tipoCliente,activo)
  VALUES (_idCliente,_tipoCliente,1);
  
  
  END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_condicion_de_pago
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_condicion_de_pago`( 
  OUT _idCondicion INT,     
  IN _descripcion VARCHAR(120),  
  IN _numDias INT,   
  IN _vigente TINYINT,    
  IN _Proveedor_idProveedor INT)
BEGIN
  
  
  INSERT INTO  CondicionPago (descripcion
  , numDias,
  vigente, 
  Proveedor_idProveedor) 
  VALUES (_descripcion, _numDias,
  1 ,_Proveedor_idProveedor ); 
  
  SET _idCondicion = @@last_insert_id; 
  
  
  END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_cuentaUsuario
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_cuentaUsuario`(
	OUT _idCuenta INT,
    IN _username VARCHAR(75),
    IN _contrasenha VARCHAR(75),
    IN _email VARCHAR(75),
    IN _TipoCuenta_idTipoCuenta INT
)
BEGIN
	INSERT INTO CuentaUsuario (username,contrasenha,email,
    TipoCuenta_idTipoCuenta,activo) 
    VALUES (_username,_contrasenha,_email,
    _TipoCuenta_idTipoCuenta,1);
	SET _idCuenta = @@last_insert_id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_descuentoliquidacion
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_descuentoliquidacion`(out id INT,in nom VARCHAR(75),in porcentaje float,in stock int,in idV int)
begin 
	insert into Descuento (nombre,activo,esAutomatico,idVigencia) values (nom,1,1,idV);
	set id=@@last_insert_id;
    insert into DescuentoLiquidacion(idDescuento,porcentajeLiquidacion,condicionStockMin) values (id,porcentaje,stock);
	
	
end$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_descuentomonto
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_descuentomonto`(out id INT,in nom VARCHAR(75),in montoE float,in montoM float,in idV int)
begin 
	insert into Descuento (nombre,activo,esAutomatico,idVigencia) values (nom,1,1,idV);
	set id=@@last_insert_id;
    insert into DescuentoMonto(idDescuento,montoEditable,montoMaximo) values (id,montoE,montoM);
	
	
end$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_descuentoporcentaje
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_descuentoporcentaje`(out id INT,in nom VARCHAR(75),in porcentaje float,in idV int)
begin 
	insert into Descuento (nombre,activo,esAutomatico,idVigencia) values (nom,1,1,idV);
	set id=@@last_insert_id;
    insert into DescuentoPorcentaje(idDescuento,porcentaje) values (id,porcentaje);
	
	
end$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_empleado
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_empleado`(
	OUT _idEmpleado INT,
    IN _nombre VARCHAR(75),
    IN _primerApellido VARCHAR(75),
    IN _segundoApellido VARCHAR(75),
    IN _dni INT,
    IN _telefono INT,
    IN _genero CHAR,
    IN _Cargo_idCargo INT,
    IN _sueldo DECIMAL(10,2)
)
BEGIN
	INSERT INTO Persona (nombre,primerApellido,segundoApellido,
    dni,telefono,genero)
    VALUES (_nombre,_primerApellido,_segundoApellido,
    _dni,_telefono,_genero);
	SET _idEmpleado = @@last_insert_id;
    INSERT INTO Empleado(idEmpleado,Cargo_idCargo,sueldo,activo)
    VALUES (_idEmpleado,_Cargo_idCargo,_sueldo,1);
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_factura
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_factura`(
    OUT _id_Comprobante INT,
    IN _FECHA DATETIME,
    IN _TOTAL DOUBLE,
    IN _IGV DOUBLE,
    IN _METODOPAGO VARCHAR(45),
    IN _CORRELATIVO VARCHAR(45),
    IN _RUC VARCHAR(11),
    IN _RAZON_SOCIAL VARCHAR(110)
)
BEGIN
    INSERT INTO ComprobanteDePago (
        fecha, total, IGV, metodoDePago, correlativo, activa
    )
    VALUES (_FECHA, _TOTAL, _IGV, _METODOPAGO, _CORRELATIVO, 1);

    SET _id_Comprobante =  @@last_insert_id;

    INSERT INTO Factura (idComprobante, RUC, razonSocial)
    VALUES (_id_Comprobante, _RUC, _RAZON_SOCIAL);
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_falda
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_falda`(
    OUT _id_prenda INT,
    IN  _nombre VARCHAR(100),
    IN  _precioUnidad DECIMAL(10,2),
    IN  _precioMayor  DECIMAL(10,2),
    IN  _precioDocena DECIMAL(10,2),
    IN  _alertaMinStock INT,
    IN  _color VARCHAR(30),
    IN  _material ENUM('Algodon','Poliester','Mezcla_algodon_poliester','Lino','Viscosa_rayon',
                       'Lana','Acrilico','Nylon','Elastano_lycra','Denim','Drill','Gabardina',
                       'Polar','Franela','Cuero','Cuerina','Saten','Chifon'),
    IN  _tipo_falda   ENUM('Mini','Midi','Larga','Tubo','Plisada','Cruzada','ShortFalda','Otro'),
    IN  _largo        DECIMAL(6,2),
    IN  _con_forro    TINYINT,
    IN  _con_volantes TINYINT
)
BEGIN
    INSERT INTO Prenda(nombre, activo, precioUnidad, precioMayor, precioDocena,
                       alertaMinStock, color, material)
    VALUES(_nombre, 1, _precioUnidad, _precioMayor, _precioDocena,
           _alertaMinStock, _color, _material);

    SET _id_prenda = @@last_insert_id;

    INSERT INTO Falda(idPrenda, tipo_falda, largo, con_forro, con_volantes)
    VALUES(_id_prenda, _tipo_falda, _largo, _con_forro, _con_volantes);
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_gorro
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_gorro`(
    OUT _id_prenda INT,
    IN  _nombre VARCHAR(100),
    IN  _precioUnidad DECIMAL(10,2),
    IN  _precioMayor  DECIMAL(10,2),
    IN  _precioDocena DECIMAL(10,2),
    IN  _alertaMinStock INT,
    IN  _color VARCHAR(30),
    IN  _material ENUM('Algodon','Poliester','Mezcla_algodon_poliester','Lino','Viscosa_rayon',
                       'Lana','Acrilico','Nylon','Elastano_lycra','Denim','Drill','Gabardina',
                       'Polar','Franela','Cuero','Cuerina','Saten','Chifon'),
    IN  _tipo_gorra ENUM('Bucket','Visera','Tejido','Beanie','Otro'),
    IN  _talla_ajustable TINYINT,
    IN  _impermeable     TINYINT
)
BEGIN
    INSERT INTO Prenda(nombre, activo, precioUnidad, precioMayor, precioDocena,
                       alertaMinStock, color, material)
    VALUES(_nombre, 1, _precioUnidad, _precioMayor, _precioDocena,
           _alertaMinStock, _color, _material);

    SET _id_prenda = LAST_INSERT_ID();

    INSERT INTO Gorro(idPrenda, tipo_gorra, talla_ajustable, impermeable)
    VALUES(_id_prenda, _tipo_gorra, _talla_ajustable, _impermeable);
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_lote
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_lote`(
	OUT _idLote int,
    _Almacen_idAlmacen int,
    _descripcion VARCHAR(255)
)
BEGIN
	INSERT INTO Lote(idLote, Almacen_idAlmacen, activo, descripcion)
    VALUES (_idLote, _Almacen_idAlmacen,  1, _descripcion);
	
	SET _idLote=@@last_insert_id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_mov_X_lote
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_mov_X_lote`(
	OUT _idMovAlmacen_X_Lote int,
    _Lote_idLote int,
    _MovimientoAlmacen_idMov_Almacen int,
    _MovimientoAlmacen_Almacen_idAlmacen int
)
BEGIN
	INSERT INTO MovimientoAlmacen_X_Lote(Lote_idLote, 
        MovimientoAlmacen_idMovAlmacen,
        MovimientoAlmacen_Almacen_idAlmacen, 
        activo)
    VALUES (_Lote_idLote, _MovimientoAlmacen_idMov_Almacen,
	_MovimientoAlmacen_Almacen_idAlmacen,  1);
	
	SET _idMovAlmacen_X_Lote=@@last_insert_id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_mov_almacen
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_mov_almacen`(
	OUT _idMovAlmacen int,
    _Almacen_idAlmacen int,
    _fecha DATE,
    _lugarDestino VARCHAR(100),
    _lugarOrigen VARCHAR(100),
    _tipo ENUM('Entrada', 'Salida', 'Mov_Interno')
)
BEGIN
	INSERT INTO MovimientoAlmacen(idMovAlmacen, Almacen_idAlmacen, fecha,
    lugarDestino, lugarOrigen, tipo, activo)
    VALUES (_idMovAlmacen, _Almacen_idAlmacen, _fecha,
	_lugarDestino, _lugarOrigen, _tipo, 1);
	
	SET _idMovAlmacen=@@last_insert_id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_nota_de_credito
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_nota_de_credito`(
    OUT _id_Comprobante INT,
    IN _FECHA DATETIME,
    IN _TOTAL DOUBLE,
    IN _IGV DOUBLE,
    IN _METODOPAGO VARCHAR(45),
    IN _CORRELATIVO VARCHAR(45),
    IN _DETALLE_MODIFICACION VARCHAR(255),
    IN _RUC VARCHAR(11),
    IN _RAZON_SOCIAL VARCHAR(45),
    IN _DNI VARCHAR(8),
    IN _MOTIVO_ESPECIFICO VARCHAR(255),
    IN _NUEVO_MONTO DOUBLE,
    IN _VALOR_AUMENTAR DOUBLE
)
BEGIN
    INSERT INTO ComprobanteDePago(
        fecha, total, IGV, metodoDePago, correlativo, activa
    )
    VALUES (_FECHA, _TOTAL, _IGV, _METODOPAGO, _CORRELATIVO, 1);

    SET _id_Comprobante = @@last_insert_id;

    INSERT INTO NotaDeCredito(
        idComprobante, detalleModificacion, RUC, razonSocial,
        DNI, motivoEspecifico, nuevoMonto, valorAumentar
    )
    VALUES (
        _id_Comprobante, _DETALLE_MODIFICACION, _RUC, _RAZON_SOCIAL,
        _DNI, _MOTIVO_ESPECIFICO, _NUEVO_MONTO, _VALOR_AUMENTAR
    );
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_nota_de_debito
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_nota_de_debito`(
    OUT _id_Comprobante INT,
    IN _FECHA DATETIME,
    IN _TOTAL DOUBLE,
    IN _IGV DOUBLE,
    IN _METODOPAGO VARCHAR(45),
    IN _CORRELATIVO VARCHAR(45),
    IN _DETALLE_MODIFICACION VARCHAR(255),
    IN _RUC VARCHAR(11),
    IN _RAZON_SOCIAL VARCHAR(45),
    IN _MOTIVO_ESPECIFICO VARCHAR(45),
    IN _NUEVO_MONTO DOUBLE,
    IN _VALOR_AUMENTAR DOUBLE,
    IN _ID_PRENDA INT
)
BEGIN
    INSERT INTO ComprobanteDePago(
        fecha, total, IGV, metodoDePago, correlativo, activa
    )
    VALUES (_FECHA, _TOTAL, _IGV, _METODOPAGO, _CORRELATIVO, 1);

    SET _id_Comprobante = @@last_insert_id;
    

    INSERT INTO NotaDeDebito(
        idComprobante, detalleModificacion, RUC, razonSocial,
        motivoEspecifico, nuevoMonto, valorAumentar, idPrenda
    )
    VALUES (
        _id_Comprobante, _DETALLE_MODIFICACION, _RUC, _RAZON_SOCIAL,
        _MOTIVO_ESPECIFICO, _NUEVO_MONTO, _VALOR_AUMENTAR, _ID_PRENDA
    );
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_orden_compra
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_orden_compra`(
	OUT _idCompra INT,
    IN _fechaLlegada datetime,
    IN _fechaEmision datetime,
    IN _deudaPendiente decimal(10,2),
    IN _montoTotal decimal(10,2),
    IN _Proveedor_idProveedor INT,
    IN _Empleado_idEmpleado INT,
    IN _activo tinyint
)
BEGIN
	
	INSERT INTO OrdenCompra (fechaLlegada,
    fechaEmision,deudaPendiente,montoTotal,
    Proveedor_idProveedor,Empleado_idEmpleado,
    activo)
    VALUES (_fechaLlegada , _fechaEmision,
    _deudaPendiente,_montoTotal,
    _Proveedor_idProveedor,_Empleado_idEmpleado, 1 );

    SET _idCompra = @@last_insert_id; 
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_pantalon
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_pantalon`(
    OUT _id_prenda INT,
    IN  _nombre VARCHAR(100),
    IN  _precioUnidad DECIMAL(10,2),
    IN  _precioMayor  DECIMAL(10,2),
    IN  _precioDocena DECIMAL(10,2),
    IN  _alertaMinStock INT,
    IN  _color VARCHAR(30),
    IN  _material ENUM('Algodon','Poliester','Mezcla_algodon_poliester','Lino','Viscosa_rayon',
                       'Lana','Acrilico','Nylon','Elastano_lycra','Denim','Drill','Gabardina',
                       'Polar','Franela','Cuero','Cuerina','Saten','Chifon'),
    IN  _tipo_pantalon ENUM('Jean','Jogger','Chino','Cargo','Buzo','Leggins','Palazzo','Otro'),
    IN  _largo_pierna DECIMAL(6,2),
    IN  _cintura      DECIMAL(6,2),
    IN  _elasticidad  TINYINT
)
BEGIN
    INSERT INTO Prenda(nombre, activo, precioUnidad, precioMayor, precioDocena,
                       alertaMinStock, color, material)
    VALUES(_nombre, 1, _precioUnidad, _precioMayor, _precioDocena,
           _alertaMinStock, _color, _material);

    SET _id_prenda = LAST_INSERT_ID();

    INSERT INTO Pantalon(idPrenda, tipo_pantalon, largo_pierna, cintura, elasticidad)
    VALUES(_id_prenda, _tipo_pantalon, _largo_pierna, _cintura, _elasticidad);
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_polo
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_polo`(
  OUT _id_prenda INT,
  IN  _nombre VARCHAR(100),
  IN  _precioUnidad DECIMAL(10,2),
  IN  _precioMayor  DECIMAL(10,2),
  IN  _precioDocena DECIMAL(10,2),
  IN  _alertaMinStock INT,
  IN  _color VARCHAR(30),
  IN  _material ENUM('Algodon','Poliester','Mezcla_algodon_poliester','Lino','Viscosa_rayon',
                     'Lana','Acrilico','Nylon','Elastano_lycra','Denim','Drill','Gabardina',
                     'Polar','Franela','Cuero','Cuerina','Saten','Chifon'),
  IN  _tipo_manga  ENUM('MangaCorta','MangaLarga','SinManga','Globo','Campana','TresCuartos'),
  IN  _estampado   VARCHAR(80),
  IN  _tipo_cuello ENUM('Redondo','V','Camisero','Alto','Halter','OffShoulder','Otro')
)
BEGIN
  INSERT INTO Prenda(nombre, activo, precioUnidad, precioMayor, precioDocena,
                     alertaMinStock, color, material)
  VALUES(_nombre, 1, _precioUnidad, _precioMayor, _precioDocena,
         _alertaMinStock, _color, _material);

  SET _id_prenda = @@last_insert_id;

  INSERT INTO Polo(idPrenda, tipo_manga, estampado, tipo_cuello)
  VALUES(_id_prenda, _tipo_manga, _estampado, _tipo_cuello);
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_prenda_lote
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_prenda_lote`(
    OUT _id_prenda_lote INT,
    IN  _id_prenda  INT,
    IN  _id_lote    INT,
    IN  _talla      ENUM('XS','S','M','L','XL','XXL'),
    IN  _stock      INT
)
BEGIN
  INSERT INTO PrendaLote(Prenda_idPrenda, Lote_idLote, talla, stock, activo)
  VALUES(_id_prenda, _id_lote, _talla, _stock, 1);
  SET _id_prenda_lote = LAST_INSERT_ID();
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_prendadescuento
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_prendadescuento`(in indP int, in indDesc int)
begin
    insert into PrendaDescuento(idPrenda,idDescuento,activo) values(indP,indDesc,1);
    
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_prendapromocion
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_prendapromocion`(in indP int, in indPro int)
begin
    insert into PrendaPromocion(idPrenda,idPromocion,activo) values(indP,indPro,1);
    
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_promocioncombo
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_promocioncombo`(out id INT,in nom VARCHAR(75),in cantReque INT, in cantGrat int ,in idV int)
begin 
	insert into Promocion (nombre,activo,esAutomatico,idVigencia) values (nom,1,1,idV);
	set id=@@last_insert_id;
    insert into PromocionCombo(idPromocion,cantidadRequerida,cantidadGratis) values (id,cantReque,cantGrat);
	
	
end$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_promocionconjunto
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_promocionconjunto`(out id INT,in nom VARCHAR(75),in porcentaje float,in idV int)
begin 
	insert into Promocion (nombre,activo,esAutomatico,idVigencia) values (nom,1,1,idV);
	set id=@@last_insert_id;
    insert into PromocionConjunto(idPromocion,porcentajePromocion) values (id,porcentaje);
	
	
end$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_proveedor
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_proveedor`(  OUT _idProveedor INT,     
IN _RUC BIGINT,     IN _nombre VARCHAR(70),   
  IN _telefono INT,     IN _direccion VARCHAR(150))
BEGIN  
  INSERT INTO Proveedor(RUC, nombre,telefono,     direccion,activo) 
  VALUES (_RUC, _nombre, _telefono, _direccion ,1);  
  SET _idProveedor = @@last_insert_id; 
  END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_tipoCuenta
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_tipoCuenta`(
	OUT _idTipoCuenta INT,
    IN _descripcion VARCHAR(75)
)
BEGIN
	INSERT INTO TipoCuenta (descripcion,activo) VALUES (
		_descripcion,1);
	SET _idTipoCuenta = @@last_insert_id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_venta
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_venta`(
	OUT _idVenta INT,
    IN _fecha datetime,
    IN _total decimal(10,2),
    IN _Comprobante_idComprobante int,
    IN _activo tinyint,
    IN _Cliente_idCliente int,
    IN _Empleado_idEmpleado int
)
BEGIN
	INSERT INTO Venta (fecha,total,
    Empleado_idEmpleado,Cliente_idCliente,
    Comprobante_idComprobante,activo)
    VALUES (_fecha,_total,
    _Empleado_idEmpleado,_Cliente_idCliente,
   _Comprobante_idComprobante,1);
	-- puede que el valor del date se pueda insertar desde acá y se pase 
    -- como parametro de salida
    SET _idVenta = @@last_insert_id; 
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_vestido
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_vestido`(
    OUT _id_prenda INT,
    IN  _nombre VARCHAR(100),
    IN  _precioUnidad DECIMAL(10,2),
    IN  _precioMayor  DECIMAL(10,2),
    IN  _precioDocena DECIMAL(10,2),
    IN  _alertaMinStock INT,
    IN  _color VARCHAR(30),
    IN  _material ENUM('Algodon','Poliester','Mezcla_algodon_poliester','Lino','Viscosa_rayon',
                       'Lana','Acrilico','Nylon','Elastano_lycra','Denim','Drill','Gabardina',
                       'Polar','Franela','Cuero','Cuerina','Saten','Chifon'),
    IN  _tipo_vestido ENUM('Coctel','Fiesta','Gala','Playa','Ejecutivo','Maxi','Mini','Casual'),
    IN  _tipo_manga   ENUM('MangaCorta','MangaLarga','SinManga','Globo','Campana','TresCuartos'),
    IN  _largo        INT
)
BEGIN
    INSERT INTO Prenda(nombre, activo, precioUnidad, precioMayor, precioDocena,
                       alertaMinStock, color, material)
    VALUES(_nombre, 1, _precioUnidad, _precioMayor, _precioDocena,
           _alertaMinStock, _color, _material);

    SET _id_prenda = LAST_INSERT_ID();

    INSERT INTO Vestido(idPrenda, tipo_vestido, largo, tipo_manga)
    VALUES(_id_prenda, _tipo_vestido, _largo, _tipo_manga);
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure insertar_vigencia
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `insertar_vigencia`(out id INT,in fecha1 date,in fecha2 date)
begin 
	insert into Vigencia (fechaInicio,fechaFin,activo) values (fecha1,fecha2,1);
	set id=@@last_insert_id;	
	
end$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure listar_boletas_todas
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `listar_boletas_todas`()
BEGIN
    SELECT 
        b.idComprobante,
        p.correlativo AS Correlativo,
        p.fecha AS fecha,
        p.IGV AS IGV,
        p.metodoDePago AS metodoDePago,
        p.total AS total,
        b.DNI AS DNI,
        p.activa AS activa
    FROM ComprobanteDePago p
    INNER JOIN Boleta b ON p.idComprobante = b.idComprobante
    WHERE p.activa = 1
    ORDER BY p.fecha DESC, b.idComprobante DESC;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure listar_facturas_todas
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `listar_facturas_todas`()
BEGIN
    SELECT 
        f.idComprobante,
        p.correlativo AS Correlativo,
        p.fecha AS fecha,
        p.IGV AS IGV,
        p.metodoDePago AS metodoDePago,
        p.total AS total,
        f.RUC AS RUC,
        f.razonSocial AS razonSocial,
        p.activa AS activa
    FROM ComprobanteDePago p
    INNER JOIN Factura f ON p.idComprobante = f.idComprobante
    WHERE p.activa = 1
    ORDER BY p.fecha DESC, f.idComprobante DESC;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure listar_notas_de_credito_todas
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `listar_notas_de_credito_todas`()
BEGIN
    SELECT 
        n.idComprobante,
        p.correlativo AS Correlativo,
        p.fecha AS fecha,
        p.IGV AS IGV,
        p.metodoDePago AS metodoDePago,
        p.total AS total,
        n.detalleModificacion AS detalleModificacion,
        n.RUC AS RUC,
        n.razonSocial AS razonSocial,
        n.DNI AS DNI,
        n.motivoEspecifico AS motivoEspecifico,
        n.nuevoMonto AS nuevoMonto,
        n.valorAumentar AS valorAumentar,
        p.activa AS activa
    FROM ComprobanteDePago p
    INNER JOIN NotaDeCredito n ON p.idComprobante = n.idComprobante
    WHERE p.activa = 1
    ORDER BY p.fecha DESC, n.idComprobante DESC;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure listar_notas_de_debito_todas
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `listar_notas_de_debito_todas`()
BEGIN
    SELECT 
        n.idComprobante,
        p.correlativo AS Correlativo,
        p.fecha AS fecha,
        p.IGV AS IGV,
        p.metodoDePago AS metodoDePago,
        p.total AS total,
        n.detalleModificacion AS detalleModificacion,
        n.RUC AS RUC,
        n.razonSocial AS razonSocial,
        n.motivoEspecifico AS motivoEspecifico,
        n.nuevoMonto AS nuevoMonto,
        n.valorAumentar AS valorAumentar,
        n.idPrenda AS idPrenda,
        p.activa AS activa
    FROM ComprobanteDePago p
    INNER JOIN NotaDeDebito n ON p.idComprobante = n.idComprobante
    WHERE p.activa = 1
    ORDER BY p.fecha DESC, n.idComprobante DESC;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_almacen
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_almacen`(
	_id int,
	_nombre varchar(70),
    _ubicacion varchar(70),
    _stock int,
    _activo tinyint,
    _idTienda int
)
BEGIN
	UPDATE Almacen 
    SET nombre=_nombre, ubicacion=_ubicacion, stock=_stock, activo=_activo, 
		Tienda_idTienda=_idTienda
    WHERE _id=idAlmacen;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_blusa
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_blusa`(
    IN  _id_prenda INT,
    IN  _nombre VARCHAR(100),
    IN  _precioUnidad DECIMAL(10,2),
    IN  _precioMayor  DECIMAL(10,2),
    IN  _precioDocena DECIMAL(10,2),
    IN  _alertaMinStock INT,
    IN  _color VARCHAR(30),
    IN  _material ENUM('Algodon','Poliester','Mezcla_algodon_poliester','Lino','Viscosa_rayon',
                       'Lana','Acrilico','Nylon','Elastano_lycra','Denim','Drill','Gabardina',
                       'Polar','Franela','Cuero','Cuerina','Saten','Chifon'),
    IN  _tipo_blusa ENUM('Camisera','CropTop','Peplum','OffShoulder','Transparente','Formal','Casual'),
    IN  _tipo_manga ENUM('MangaCorta','MangaLarga','SinManga','Globo','Campana','TresCuartos')
)
BEGIN
    UPDATE Prenda
       SET nombre        = _nombre,
           precioUnidad  = _precioUnidad,
           precioMayor   = _precioMayor,
           precioDocena  = _precioDocena,
           alertaMinStock= _alertaMinStock,
           color         = _color,
           material      = _material
     WHERE idPrenda = _id_prenda;

    UPDATE Blusa
       SET tipo_blusa = _tipo_blusa,
           tipo_manga = _tipo_manga
     WHERE idPrenda = _id_prenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_boleta
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_boleta`(
    IN _id_Comprobante INT,
    IN _FECHA DATETIME,
    IN _TOTAL DOUBLE,
    IN _IGV DOUBLE,
    IN _METODOPAGO VARCHAR(45),
    IN _CORRELATIVO VARCHAR(45),
    IN _DNI VARCHAR(8)
)
BEGIN
    UPDATE ComprobanteDePago
       SET fecha = _FECHA,
           total = _TOTAL,
           IGV = _IGV,
           metodoDePago = _METODOPAGO,
           correlativo = _CORRELATIVO
     WHERE idComprobante = _id_Comprobante;

    UPDATE Boleta
       SET DNI = _DNI
     WHERE idComprobante = _id_Comprobante;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_cargo
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_cargo`(
	IN _idCargo INT,
	IN _abreviatura CHAR,
    IN _descripcion VARCHAR(75)
)
BEGIN
	UPDATE Cargo
    SET abreviatura=_abreviatura,
    descripcion=_descripcion
    WHERE idCargo=_idCargo;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_casaca
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_casaca`(
	IN  _id_prenda INT,
    IN  _nombre VARCHAR(100),
    IN  _precioUnidad DECIMAL(10,2),
    IN  _precioMayor  DECIMAL(10,2),
    IN  _precioDocena DECIMAL(10,2),
    IN  _alertaMinStock INT,
    IN  _color VARCHAR(30),
    IN  _material ENUM('Algodon','Poliester','Mezcla_algodon_poliester','Lino','Viscosa_rayon',
                       'Lana','Acrilico','Nylon','Elastano_lycra','Denim','Drill','Gabardina',
                       'Polar','Franela','Cuero','Cuerina','Saten','Chifon'),
    IN  _tipo_casaca  ENUM('Bomber','Puffer','Denim','Deportiva','Cuero','Cardigan','Otro'),
    IN  _con_capucha TINYINT
)
BEGIN
	UPDATE Prenda
       SET nombre = _nombre,
           precioUnidad = _precioUnidad,
           precioMayor  = _precioMayor,
           precioDocena = _precioDocena,
           alertaMinStock = _alertaMinStock,
           color = _color,
           material = _material
     WHERE idPrenda = _id_prenda;

    UPDATE Casaca
       SET tipo_casaca  = _tipo_casaca,
           con_capucha = _con_capucha
     WHERE idPrenda = _id_prenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_cliente
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_cliente`( 
 IN _idCliente INT,     
IN _nombre VARCHAR(75),     
IN _primerApellido VARCHAR(75),   
  IN _segundoApellido VARCHAR(75),  
  IN _dni INT,
  IN _telefono INT,
  IN _genero CHAR , 
  IN _abreviatura CHAR(1),
  IN _descripcion VARCHAR(120),
  IN _tipoCliente INT
  )
BEGIN  
  
  UPDATE Persona SET nombre=_nombre,
  primerApellido=_primerApellido,
  segundoApellido=_segundoApellido,
  dni=_dni,
  telefono=_telefono,
  genero=_genero
  WHERE idPersona=_idCliente;
  
  UPDATE TipoDeCliente SET 
  abreviatura=_abreviatura,
  descripcion=_descripcion
  WHERE tipoCliente=_tipoCliente;
  
  
  
  END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_cuentaUsuario
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_cuentaUsuario`(
	IN _idCuenta INT,
    IN _username VARCHAR(75),
    IN _contrasenha VARCHAR(75),
    IN _email VARCHAR(75),
    IN _TipoCuenta_idTipoCuenta INT
)
BEGIN
	UPDATE CuentaUsuario
    SET username=_username, contrasenha=_contrasenha, 
    email=_email, 
    TipoCuenta_idTipoCuenta=_TipoCuenta_idTipoCuenta
    WHERE idCuenta=_idCuenta;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_descuentoliquidacion
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_descuentoliquidacion`(in id int, in nomb VARCHAR(75),in porcentaje float,in stock int)
BEGIN
		update Descuento 
        set nombre=nomb
        where idDescuento=id;
        
		update DescuentoLiquidacion 
        set porcentajeLiquidacion=porcentaje, condicionStockMin=stock
        where idDescuento=id;

END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_descuentomonto
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_descuentomonto`(in id int, in nomb VARCHAR(75),in montoE float,in montoD float)
BEGIN
		update Descuento 
        set nombre=nomb
        where idDescuento=id;
        
		update DescuentoMonto 
        set montoEditable=montoE, montoMaximo=montoD
        where idDescuento=id;

END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_descuentoporcentaje
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_descuentoporcentaje`(in id int, in nomb VARCHAR(75),in porcen float )
BEGIN
		update Descuento 
        set nombre=nomb
        where idDescuento=id;
        
		update DescuentoPorcentaje 
        set porcentaje=porcen
        where idDescuento=id;

END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_empleado
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_empleado`(
	IN _idEmpleado INT,
    IN _nombre VARCHAR(75),
    IN _primerApellido VARCHAR(75),
    IN _segundoApellido VARCHAR(75),
    IN _dni INT,
    IN _telefono INT,
    IN _genero CHAR,
    IN _Cargo_idCargo INT,
    IN _sueldo DECIMAL(10,2)
)
BEGIN
	UPDATE Persona SET nombre=_nombre,
    primerApellido=_primerApellido,
    segundoApellido=_segundoApellido,
    dni=_dni,telefono=_telefono,genero=_genero
    WHERE idPersona=_idEmpleado;

    UPDATE Empleado SET Cargo_idCargo=_Cargo_idCargo,
    sueldo=_sueldo
    WHERE idEmpleado=_idEmpleado;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_factura
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_factura`(
    IN _id_Comprobante INT,
    IN _FECHA DATETIME,
    IN _TOTAL DOUBLE,
    IN _IGV DOUBLE,
    IN _METODOPAGO VARCHAR(45),
    IN _CORRELATIVO VARCHAR(45),
    IN _RUC VARCHAR(11),
    IN _RAZON_SOCIAL VARCHAR(110)
)
BEGIN
    UPDATE ComprobanteDePago
       SET fecha = _FECHA,
           total = _TOTAL,
           IGV = _IGV,
           metodoDePago = _METODOPAGO,
           correlativo = _CORRELATIVO
     WHERE idComprobante = _id_Comprobante;

    UPDATE Factura
       SET RUC = _RUC,
           razonSocial = _RAZON_SOCIAL
     WHERE idComprobante = _id_Comprobante;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_falda
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_falda`(
    IN  _id_prenda INT,
    IN  _nombre VARCHAR(100),
    IN  _precioUnidad DECIMAL(10,2),
    IN  _precioMayor  DECIMAL(10,2),
    IN  _precioDocena DECIMAL(10,2),
    IN  _alertaMinStock INT,
    IN  _color VARCHAR(30),
    IN  _material ENUM('Algodon','Poliester','Mezcla_algodon_poliester','Lino','Viscosa_rayon',
                       'Lana','Acrilico','Nylon','Elastano_lycra','Denim','Drill','Gabardina',
                       'Polar','Franela','Cuero','Cuerina','Saten','Chifon'),
    IN  _tipo_falda   ENUM('Mini','Midi','Larga','Tubo','Plisada','Cruzada','ShortFalda','Otro'),
    IN  _largo        DECIMAL(6,2),
    IN  _con_forro    TINYINT,
    IN  _con_volantes TINYINT
)
BEGIN
    UPDATE Prenda
       SET nombre = _nombre,
           precioUnidad = _precioUnidad,
           precioMayor  = _precioMayor,
           precioDocena = _precioDocena,
           alertaMinStock = _alertaMinStock,
           color = _color,
           material = _material
     WHERE idPrenda = _id_prenda;

    UPDATE Falda
       SET tipo_falda   = _tipo_falda,
           largo        = _largo,
           con_forro    = _con_forro,
           con_volantes = _con_volantes
     WHERE idPrenda = _id_prenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_gorro
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_gorro`(
    IN  _id_prenda INT,
    IN  _nombre VARCHAR(100),
    IN  _precioUnidad DECIMAL(10,2),
    IN  _precioMayor  DECIMAL(10,2),
    IN  _precioDocena DECIMAL(10,2),
    IN  _alertaMinStock INT,
    IN  _color VARCHAR(30),
    IN  _material ENUM('Algodon','Poliester','Mezcla_algodon_poliester','Lino','Viscosa_rayon',
                       'Lana','Acrilico','Nylon','Elastano_lycra','Denim','Drill','Gabardina',
                       'Polar','Franela','Cuero','Cuerina','Saten','Chifon'),
    IN  _tipo_gorra ENUM('Bucket','Visera','Tejido','Beanie','Otro'),
    IN  _talla_ajustable TINYINT,
    IN  _impermeable     TINYINT
)
BEGIN
    UPDATE Prenda
       SET nombre        = _nombre,
           precioUnidad  = _precioUnidad,
           precioMayor   = _precioMayor,
           precioDocena  = _precioDocena,
           alertaMinStock= _alertaMinStock,
           color         = _color,
           material      = _material
     WHERE idPrenda = _id_prenda;

    UPDATE Gorro
       SET tipo_gorra      = _tipo_gorra,
           talla_ajustable = _talla_ajustable,
           impermeable     = _impermeable
     WHERE idPrenda = _id_prenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_lote
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_lote`(
	_idLote int,
    _Almacen_idAlmacen int,
    _activo TINYINT,
    _descripcion VARCHAR(255)
)
BEGIN
	UPDATE Lote SET Almacen_idAlmacen=_Almacen_idAlmacen, activo=_activo, descripcion=_descripcion
	WHERE idLote=_idLote;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_mov_X_lote
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_mov_X_lote`(
	_idMovAlmacen_X_Lote int,
    _Lote_idLote int,
    _MovimientoAlmacen_idMov_Almacen int,
    _MovimientoAlmacen_Almacen_idAlmacen int,
    _activo tinyint
)
BEGIN
    UPDATE MovimientoAlmacen_X_Lote SET Lote_idLote=_Lote_idLote, 
		MovimientoAlmacen_idMovAlmacen=_MovimientoAlmacen_idMov_Almacen,
        MovimientoAlmacen_Almacen_idAlmacen=_MovimientoAlmacen_Almacen_idAlmacen, activo=_activo
	WHERE idMovAlmacen_X_Lote=_idMovAlmacen_X_Lote;
    
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_mov_almacen
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_mov_almacen`(
	_idMovAlmacen int,
    _Almacen_idAlmacen int,
    _fecha DATE,
    _lugarDestino VARCHAR(100),
    _lugarOrigen VARCHAR(100),
    _tipo_lote ENUM('Entrada', 'Salida', 'Mov_Interno'),
    _activo TINYINT
)
BEGIN
	UPDATE MovimientoAlmacen
    SET Almacen_idAlmacen=_Almacen_idAlmacen, fecha=_fecha,
    lugarDestino=_lugarDestino, lugarOrigen=_lugarOrigen, tipo=_tipo_lote, activo=_activo
    WHERE idMovAlmacen=_idMovAlmacen;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_nota_de_credito
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_nota_de_credito`(
    IN _id_Comprobante INT,
    IN _FECHA DATETIME,
    IN _TOTAL DOUBLE,
    IN _IGV DOUBLE,
    IN _METODOPAGO VARCHAR(45),
    IN _CORRELATIVO VARCHAR(45),
    IN _DETALLE_MODIFICACION VARCHAR(255),
    IN _RUC VARCHAR(11),
    IN _RAZON_SOCIAL VARCHAR(45),
    IN _DNI VARCHAR(8),
    IN _MOTIVO_ESPECIFICO VARCHAR(255),
    IN _NUEVO_MONTO DOUBLE,
    IN _VALOR_AUMENTAR DOUBLE
)
BEGIN
    UPDATE ComprobanteDePago
       SET fecha = _FECHA,
           total = _TOTAL,
           IGV = _IGV,
           metodoDePago = _METODOPAGO,
           correlativo = _CORRELATIVO
     WHERE idComprobante = _id_Comprobante;

    UPDATE NotaDeCredito
       SET detalleModificacion = _DETALLE_MODIFICACION,
           RUC = _RUC,
           razonSocial = _RAZON_SOCIAL,
           DNI = _DNI,
           motivoEspecifico = _MOTIVO_ESPECIFICO,
           nuevoMonto = _NUEVO_MONTO,
           valorAumentar = _VALOR_AUMENTAR
     WHERE idComprobante = _id_Comprobante;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_nota_de_debito
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_nota_de_debito`(
    IN _id_Comprobante INT,
    IN _FECHA DATETIME,
    IN _TOTAL DOUBLE,
    IN _IGV DOUBLE,
    IN _METODOPAGO VARCHAR(45),
    IN _CORRELATIVO VARCHAR(45),
    IN _DETALLE_MODIFICACION VARCHAR(255),
    IN _RUC VARCHAR(11),
    IN _RAZON_SOCIAL VARCHAR(45),
    IN _MOTIVO_ESPECIFICO VARCHAR(45),
    IN _NUEVO_MONTO DOUBLE,
    IN _VALOR_AUMENTAR DOUBLE,
    IN _ID_PRENDA INT
)
BEGIN
    UPDATE ComprobanteDePago
       SET fecha = _FECHA,
           total = _TOTAL,
           IGV = _IGV,
           metodoDePago = _METODOPAGO,
           correlativo = _CORRELATIVO
     WHERE idComprobante = _id_Comprobante;

    UPDATE NotaDeDebito
       SET detalleModificacion = _DETALLE_MODIFICACION,
           RUC = _RUC,
           razonSocial = _RAZON_SOCIAL,
           motivoEspecifico = _MOTIVO_ESPECIFICO,
           nuevoMonto = _NUEVO_MONTO,
           valorAumentar = _VALOR_AUMENTAR,
           idPrenda = _ID_PRENDA
     WHERE idComprobante = _id_Comprobante;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_orden_compra
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_orden_compra`(
	IN _idCompra INT,
    IN _fechaLlegada datetime,
    IN _fechaEmision datetime,
    IN _deudaPendiente decimal(10,2),
    IN _montoTotal decimal(10,2),
    IN _Proveedor_idProveedor INT,
    IN _Empleado_idEmpleado INT,
    IN _activo tinyint
)
BEGIN
	UPDATE LineaLoteCompra
    SET activo = 0
    WHERE OrdenCompra_idCompra = _idCompra ;
    
	UPDATE OrdenCompra 
    SET 
    fechaLlegada = _fechaLlegada,
    fechaEmision = _fechaEmision,
    deudaPendiente = _deudaPendiente,
    montoTotal = _montoTotal,
    Proveedor_idProveedor = _Proveedor_idProveedor,
    Empleado_idEmpleado = _Empleado_idEmpleado
    WHERE idCompra = _idCompra;
    
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_pantalon
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_pantalon`(
    IN  _id_prenda INT,
    IN  _nombre VARCHAR(100),
    IN  _precioUnidad DECIMAL(10,2),
    IN  _precioMayor  DECIMAL(10,2),
    IN  _precioDocena DECIMAL(10,2),
    IN  _alertaMinStock INT,
    IN  _color VARCHAR(30),
    IN  _material ENUM('Algodon','Poliester','Mezcla_algodon_poliester','Lino','Viscosa_rayon',
                       'Lana','Acrilico','Nylon','Elastano_lycra','Denim','Drill','Gabardina',
                       'Polar','Franela','Cuero','Cuerina','Saten','Chifon'),
    IN  _tipo_pantalon ENUM('Jean','Jogger','Chino','Cargo','Buzo','Leggins','Palazzo','Otro'),
    IN  _largo_pierna DECIMAL(6,2),
    IN  _cintura      DECIMAL(6,2),
    IN  _elasticidad  TINYINT
)
BEGIN
    UPDATE Prenda
       SET nombre        = _nombre,
           precioUnidad  = _precioUnidad,
           precioMayor   = _precioMayor,
           precioDocena  = _precioDocena,
           alertaMinStock= _alertaMinStock,
           color         = _color,
           material      = _material
     WHERE idPrenda = _id_prenda;

    UPDATE Pantalon
       SET tipo_pantalon = _tipo_pantalon,
           largo_pierna  = _largo_pierna,
           cintura       = _cintura,
           elasticidad   = _elasticidad
     WHERE idPrenda = _id_prenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_polo
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_polo`(
    IN  _id_prenda INT,
    IN  _nombre VARCHAR(100),
    IN  _precioUnidad DECIMAL(10,2),
    IN  _precioMayor  DECIMAL(10,2),
    IN  _precioDocena DECIMAL(10,2),
    IN  _alertaMinStock INT,
    IN  _color VARCHAR(30),
    IN  _material ENUM('Algodon','Poliester','Mezcla_algodon_poliester','Lino','Viscosa_rayon',
                       'Lana','Acrilico','Nylon','Elastano_lycra','Denim','Drill','Gabardina',
                       'Polar','Franela','Cuero','Cuerina','Saten','Chifon'),
    IN  _tipo_manga  ENUM('MangaCorta','MangaLarga','SinManga','Globo','Campana','TresCuartos'),
    IN  _estampado   VARCHAR(80),
    IN  _tipo_cuello ENUM('Redondo','V','Camisero','Alto','Halter','OffShoulder','Otro')
)
BEGIN
    UPDATE Prenda
       SET nombre = _nombre,
           precioUnidad = _precioUnidad,
           precioMayor  = _precioMayor,
           precioDocena = _precioDocena,
           alertaMinStock = _alertaMinStock,
           color = _color,
           material = _material
     WHERE idPrenda = _id_prenda;

    UPDATE Polo
       SET tipo_manga  = _tipo_manga,
           estampado   = _estampado,
           tipo_cuello = _tipo_cuello
     WHERE idPrenda = _id_prenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_prenda_lote
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_prenda_lote`(
    IN _id_prenda_lote INT,
    IN _stock          INT,
    IN _activo         TINYINT
)
BEGIN
  UPDATE PrendaLote
     SET stock  = _stock,
         activo = _activo
   WHERE idPrendaLote = _id_prenda_lote;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_promocioncombo
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_promocioncombo`(in id int, in nomb VARCHAR(75),in cantReque int , in cantGrat int,in indV int)
BEGIN
		update Promocion 
        set nombre=nomb, idVigencia=indV 
        where idPromocion=id;
        
		update PromocionCombo 
        set cantidadRequerida=cantReque, cantidadGratis=cantGrat 
        where idPromocion=id;

END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_promocionconjunto
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_promocionconjunto`(in id int, in nomb VARCHAR(75),in promocion float,in indV int)
BEGIN
		update Promocion 
        set nombre=nomb, idVigencia=indV 
        where idPromocion=id;
        
		update PromocionConjunto 
        set porcentajePromocion=promocion 
        where idPromocion=id;

END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_proveedor
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_proveedor`(  
IN _idProveedor INT,     
IN _RUC BIGINT,   
  IN _nombre VARCHAR(70),   
  IN _telefono INT,   
  IN _direccion VARCHAR(150), 
  IN _activo TINYINT)
BEGIN  
  
  UPDATE CondicionPago
    SET vigente = 0
    WHERE Proveedor_idProveedor = _idProveedor ;
  
  UPDATE Proveedor SET RUC=_RUC,
  nombre=_nombre,telefono=_telefono,direccion=_direccion
  WHERE idProveedor=_idProveedor;
  END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_tipoCuenta
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_tipoCuenta`(
	IN _idTipoCuenta INT,
    IN _descripcion VARCHAR(75)
)
BEGIN
	UPDATE TipoCuenta
    SET descripcion=_descripcion
    WHERE idTipoCuenta=_idTipoCuenta;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_venta
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_venta`(
	IN _idVenta INT,
    IN _fecha datetime,
    IN _total decimal(10,2),
    IN _Empleado_idEmpleado INT,
    IN _Cliente_idCliente INT,
    IN _Comprobante_idComprobante INT
)
BEGIN
	UPDATE ItemVenta
    SET activo = 0
    WHERE Venta_idVenta = _idVenta;
    
	UPDATE Venta 
    SET fecha = 
    _fecha,
    total = _total, 
    Empleado_idEmpleado = _Empleado_idEmpleado,
    Cliente_idCliente = _Cliente_idCliente,
    Comprobante_idComprobante = _Comprobante_idComprobante
    WHERE idVenta = _idVenta;
    
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_vestido
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_vestido`(
    IN  _id_prenda INT,
    IN  _nombre VARCHAR(100),
    IN  _precioUnidad DECIMAL(10,2),
    IN  _precioMayor  DECIMAL(10,2),
    IN  _precioDocena DECIMAL(10,2),
    IN  _alertaMinStock INT,
    IN  _color VARCHAR(30),
    IN  _material ENUM('Algodon','Poliester','Mezcla_algodon_poliester','Lino','Viscosa_rayon',
                       'Lana','Acrilico','Nylon','Elastano_lycra','Denim','Drill','Gabardina',
                       'Polar','Franela','Cuero','Cuerina','Saten','Chifon'),
    IN  _tipo_vestido ENUM('Coctel','Fiesta','Gala','Playa','Ejecutivo','Maxi','Mini','Casual'),
    IN  _tipo_manga   ENUM('MangaCorta','MangaLarga','SinManga','Globo','Campana','TresCuartos'),
    IN  _largo        INT
)
BEGIN
    UPDATE Prenda
       SET nombre        = _nombre,
           precioUnidad  = _precioUnidad,
           precioMayor   = _precioMayor,
           precioDocena  = _precioDocena,
           alertaMinStock= _alertaMinStock,
           color         = _color,
           material      = _material
     WHERE idPrenda = _id_prenda;

    UPDATE Vestido
       SET tipo_vestido = _tipo_vestido,
           largo        = _largo,
           tipo_manga   = _tipo_manga
     WHERE idPrenda = _id_prenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure modificar_vigencia
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `modificar_vigencia`(in id INT,in fecha1 date, in fecha2 date)
begin
	update Vigencia 
    set fechaInicio=fecha1,fechaFin=fecha2
    where idVigencia=id;
end$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_Lineas_Lote_compra_X_ID_compra
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_Lineas_Lote_compra_X_ID_compra`(
	IN _idCompra INT
)
BEGIN
	SELECT 
    lineaLotComp.idPrenda AS id_Prenda_linlote,
    lineaLotComp.numLinea AS num_linea_linlote,
    lineaLotComp.cantidad AS cantidad_linlote,
    lineaLotComp.talla AS talla_linlote,
    
    lineaLotComp.lote_idLote AS id_lote_linlote,
    lot.Almacen_idAlmacen AS almacen_id,
    lot.activo as activo_lote,
    
    
    lineaLotComp.precioLote AS precio_lote_linlote,
    lineaLotComp.OrdenCompra_idCompra AS id_orden_linlote,
    lineaLotComp.activo AS activo_linlote
    
    
    FROM
    LineaLoteCompra lineaLotComp INNER JOIN 
    Lote lot ON
    lineaLotComp.lote_idLote = lot.idLote
    WHERE lineaLotComp.OrdenCompra_idCompra = _idCompra;
    
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_Lineas_Lote_compra_X_ID_compra_activos
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_Lineas_Lote_compra_X_ID_compra_activos`(
	IN _idCompra INT
)
BEGIN
	SELECT 
    lineaLotComp.idPrenda AS id_Prenda_linlote,
    lineaLotComp.numLinea AS num_linea_linlote,
    lineaLotComp.cantidad AS cantidad_linlote,
    lineaLotComp.talla AS talla_linlote,
    
    lineaLotComp.lote_idLote AS id_lote_linlote,
    lot.Almacen_idAlmacen AS almacen_id,
    lot.activo as activo_lote,
    
    
    lineaLotComp.precioLote AS precio_lote_linlote,
    lineaLotComp.OrdenCompra_idCompra AS id_orden_linlote,
    lineaLotComp.activo AS activo_linlote
    
    
    FROM
    LineaLoteCompra lineaLotComp INNER JOIN 
    Lote lot ON
    lineaLotComp.lote_idLote = lot.idLote
    WHERE lineaLotComp.OrdenCompra_idCompra = _idCompra
    AND lineaLotComp.activo = 1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_almacenes
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_almacenes`()
BEGIN
	SELECT *FROM Almacen;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_almacenes_activos
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_almacenes_activos`()
BEGIN
	SELECT *FROM Almacen
    WHERE activo=1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_blusas
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_blusas`()
BEGIN
  SELECT *
    FROM Prenda p
    JOIN Blusa  b ON b.idPrenda = p.idPrenda
    WHERE p.activo = 1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_cargos
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_cargos`()
BEGIN
	SELECT *
    FROM Cargo;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_casacas
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_casacas`(
)
BEGIN
    SELECT  p.idPrenda, p.nombre, p.stockPrenda, p.precioUnidad, p.precioMayor, p.precioDocena,
            p.alertaMinStock, p.color, p.material,p.activo,
            c.tipo_casaca, c.con_capucha
      FROM  Prenda p
      JOIN  Casaca c ON c.idPrenda = p.idPrenda
      where p.activo = 1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_clientes
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_clientes`()
BEGIN
  
  
  SELECT c.idCliente, c.activo,p.nombre,
    p.primerApellido,p.segundoApellido,
    p.dni,p.telefono,p.genero,
    t.tipoCliente,t.abreviatura,t.descripcion
    FROM Cliente c INNER JOIN 
	Persona p ON c.idCliente=p.idPersona
	INNER JOIN TipoDeCliente t ON c.tipoCliente = t.tipoCliente;
  
  
  END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_condiciones_de_Pago_X_idproveedor
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_condiciones_de_Pago_X_idproveedor`(
	IN _idProveedor INT
)
BEGIN
	SELECT 
    condicion.idCondicion AS id_condicon,
    condicion.descripcion AS descripcion_condicion,
    condicion.numDias AS num_dias_condicion,
    condicion.vigente AS vigente_condicion,
    condicion.Proveedor_idProveedor AS id_proveedor_condicion
    FROM
    CondicionPago condicion 
    WHERE condicion.Proveedor_idProveedor = _idProveedor;
    
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_condiciones_de_Pago_X_idproveedor_activo
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_condiciones_de_Pago_X_idproveedor_activo`(
	IN _idProveedor INT
)
BEGIN
	SELECT 
    condicion.idCondicion AS id_condicon,
    condicion.descripcion AS descripcion_condicion,
    condicion.numDias AS num_dias_condicion,
    condicion.vigente AS vigente_condicion,
    condicion.Proveedor_idProveedor AS id_proveedor_condicion
    FROM
    CondicionPago condicion 
    WHERE condicion.Proveedor_idProveedor = _idProveedor AND
    condicion.vigente = 1;
    
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_cuentaUsuarios
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_cuentaUsuarios`()
BEGIN
	SELECT c.idCuenta, c.username, c.contrasenha, c.email,
    t.idTipoCuenta, t.descripcion
    FROM CuentaUsuario c
    INNER JOIN TipoCuenta t ON t.idTipoCuenta=c.TipoCuenta_idTipoCuenta
    WHERE c.activo=1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_descuentoLiquidacionXPrenda
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_descuentoLiquidacionXPrenda`(in indP int)
BEGIN
	select  dm.idDescuento as idDescuento, d.nombre as nombre,dl.porcentajeLiquidacion as porcentajeLiquidacion, dl.condicionStockMin as condicionStockMin
    from PrendaDescuento p , DescuentoLiquidacion dl, Descuento d
    where p.idPrenda=indP and p.idDescuento=d.idDscuento and dl.idDescuento=d.idDescuento and p.activo=1;

END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_descuentoMontoXPrenda
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_descuentoMontoXPrenda`(in indP int)
BEGIN
	select  dm.idDescuento as idDescuento, d.nombre as nombre,dm.montoEditable  as montoEditable, dm.montoMaximo as montoMaximo 
    from PrendaDescuento p , DescuentoMonto dm, Descuento d
    where p.idPrenda=indP and p.idDescuento=d.idDscuento and dm.idDescuento=d.idDescuento and p.activo=1;

END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_descuentoPorcentajeXPrenda
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_descuentoPorcentajeXPrenda`(in indP int)
BEGIN
	select  dm.idDescuento as idDescuento, d.nombre as nombre,dp.porcentaje as porcentaje 
    from PrendaDescuento p , DescuentoPorcentaje dp, Descuento d
    where p.idPrenda=indP and p.idDescuento=d.idDscuento and dp.idDescuento=d.idDescuento and p.activo=1;

END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_descuentoliquidacion
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_descuentoliquidacion`()
Begin

select d.idDescuento as idDescuento, d.nombre as nombre, dp.porcentajeLiquidacion as porcentajeLiquidacion,dp.condicionStockMin as condicionStockMin,
    d.activo as activo,
    d.esAutomatico as esAutomatico, d.idVigencia as idVigencia from DescuentoLiquidacion dp, Descuento d 
    where dp.idDescuento=d.idDescuento;
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_descuentoliquidacion_activo
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_descuentoliquidacion_activo`()
Begin

select d.idDescuento as idDescuento, d.nombre as nombre, dp.porcentajeLiquidacion as porcentajeLiquidacion,dp.condicionStockMin as condicionStockMin,
    d.activo as activo,
    d.esAutomatico as esAutomatico, d.idVigencia as idVigencia from DescuentoLiquidacion dp, Descuento d 
    where dp.idDescuento=d.idDescuento and d.activo=1;
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_descuentomonto
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_descuentomonto`()
Begin

select d.idDescuento as idDescuento, d.nombre as nombre, dp.montoEditable as montoEditable,dp.montoMaximo as montoMaximo,
    d.activo as activo,
    d.esAutomatico as esAutomatico, d.idVigencia as idVigencia from DescuentoMonto dp, Descuento d 
    where dp.idDescuento=d.idDescuento;
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_descuentomonto_activo
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_descuentomonto_activo`()
Begin

select d.idDescuento as idDescuento, d.nombre as nombre, dp.montoEditable as montoEditable,dp.montoMaximo as montoMaximo,
    d.activo as activo,
    d.esAutomatico as esAutomatico, d.idVigencia as idVigencia from DescuentoMonto dp, Descuento d 
    where dp.idDescuento=d.idDescuento and d.activo=1;
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_descuentoporcentaje
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_descuentoporcentaje`()
Begin

select dp.idDescuento, d.nombre as nombre,dp.porcentaje as porcentaje,d.idVigencia as idVigencia,d.esAutomatico as esAutomatico, d.activo as activo
 from DescuentoPorcentaje dp, Descuento d where d.idDescuento=dp.idDescuento;
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_descuentoporcentaje_activos
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_descuentoporcentaje_activos`()
Begin

select dp.idDescuento, d.nombre as nombre,dp.porcentaje as porcentaje,d.idVigencia as idVigencia,d.esAutomatico as esAutomatico, d.activo as activo
 from DescuentoPorcentaje dp, Descuento d where d.idDescuento=dp.idDescuento and d.activo=1;
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_empleados
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_empleados`()
BEGIN
	SELECT p.idPersona, p.nombre, p.primerApellido, p.segundoApellido,
    p.dni, p.telefono, p.genero, e.sueldo, c.idCargo, c.abreviatura,
    c.descripcion
    FROM Persona p
    INNER JOIN Empleado e ON p.idPersona=e.idEmpleado
    INNER JOIN Cargo c ON c.idCargo=e.Cargo_idCargo
    WHERE e.activo=1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_faldas
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_faldas`()
BEGIN
  SELECT  *
    FROM  Prenda p
    JOIN  Falda  f ON f.idPrenda = p.idPrenda
    WHERE p.activo = 1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_gorros
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_gorros`()
BEGIN
  SELECT *
    FROM Prenda p
    JOIN Gorro  g ON g.idPrenda = p.idPrenda
    WHERE p.activo = 1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_items_venta_X_ID_venta
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_items_venta_X_ID_venta`(
	IN _Venta_idVenta INT
)
BEGIN
	SELECT 
    itemVent.numLinea AS  numero_linea,
    itemVent.Prenda_idPrenda AS prendaID,
    itemVent.cantidad AS cantidad_item,
    itemVent.subtotal AS subtotal_item,
    itemVent.Venta_idVenta AS id_venta,
    itemVent.activo AS estado_Item
    FROM
    ItemVenta itemVent INNER JOIN  Prenda prend ON
    itemVent.Prenda_idPrenda = prend.idPrenda 
    WHERE itemVent.Venta_idVenta =  _Venta_idVenta;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_items_venta_X_ID_venta_activos
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_items_venta_X_ID_venta_activos`(
	IN _Venta_idVenta INT
)
BEGIN
	SELECT 
    itemVent.numLinea AS  numero_linea,
    itemVent.Prenda_idPrenda AS prendaID,
    itemVent.cantidad AS cantidad_item,
    itemVent.subtotal AS subtotal_item,
    itemVent.Venta_idVenta AS id_venta,
    itemVent.activo AS estado_Item
    FROM
    ItemVenta itemVent INNER JOIN  Prenda prend ON
    itemVent.Prenda_idPrenda = prend.idPrenda 
    WHERE itemVent.Venta_idVenta =  _Venta_idVenta AND 
    itemVent.activo = 1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_lote_activo_por_almacen
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_lote_activo_por_almacen`(
    IN _idAlmacen INT
)
BEGIN
    -- Validación del parámetro de entrada
    IF _idAlmacen IS NULL OR _idAlmacen <= 0 THEN
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'El ID del almacén debe ser un valor positivo válido';
    END IF;
    
    -- Consulta principal
    SELECT *
    FROM 
        Lote
    WHERE 
        activo = 1 
        AND Almacen_idAlmacen = _idAlmacen;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_lotes
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_lotes`()
BEGIN
    SELECT*FROM Lote;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_lotes_activos
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_lotes_activos`()
BEGIN
	SELECT* FROM Lote WHERE activo=1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_mov_X_lote
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_mov_X_lote`()
BEGIN
    SELECT*FROM MovimientoAlmacen_X_Lote;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_mov_X_lote_activos
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_mov_X_lote_activos`()
BEGIN
    SELECT*FROM MovimientoAlmacen_X_Lote WHERE activo=1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_mov_X_lote_activos_por_almacen
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_mov_X_lote_activos_por_almacen`(
	_idAlmacen INT
)
BEGIN
	SELECT
        MQL.idMovAlmacen_X_Lote,         -- 1. idMovAlmacen_X_Lote
        L.idLote,                        -- 2. ID Lote
        MA.idMovAlmacen,                 -- 3. ID Movimiento
        MA.Almacen_idAlmacen,            -- 4. ID Almacen del Movimiento
        MA.tipo,                         -- 5. Tipo de Movimiento
        MA.lugarDestino,                 -- 6. Lugar Destino
        MA.lugarOrigen,                  -- 7. Lugar Origen
        L.descripcion,                   -- 8. Descripción Lote
        MQL.activo                       -- 9. Activo (para la relación)
        -- Nota: No necesitamos L.Almacen_idAlmacen ni MA.activo, MA.Almacen_idAlmacen aquí,
        -- pero se pueden añadir si el mapeo Java lo requiere.
    FROM
        MovimientoAlmacen_X_Lote MQL
    INNER JOIN
        MovimientoAlmacen MA ON MQL.MovimientoAlmacen_idMovAlmacen = MA.idMovAlmacen
    INNER JOIN
        Lote L ON MQL.Lote_idLote = L.idLote
    WHERE
        MA.Almacen_idAlmacen = _idAlmacen
        AND L.Almacen_idAlmacen = _idAlmacen
        AND MA.activo = 1
        AND L.activo = 1
        AND MQL.activo = 1
    ORDER BY
        MA.idMovAlmacen, L.idLote;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_mov_activo_por_almacen
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_mov_activo_por_almacen`(
    IN _idAlmacen INT
)
BEGIN
    -- Validación del parámetro de entrada
    IF _idAlmacen IS NULL OR _idAlmacen <= 0 THEN
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'El ID del almacén debe ser un valor positivo válido';
    END IF;
    
    -- Consulta principal
    SELECT 
        idMovAlmacen,
        Almacen_idAlmacen,
        fecha,
        lugarDestino,
        lugarOrigen,
        tipo,
        activo
    FROM 
        MovimientoAlmacen
    WHERE 
        activo = 1 
        AND Almacen_idAlmacen = _idAlmacen;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_mov_almacenes
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_mov_almacenes`()
BEGIN
	SELECT idMovAlmacen, Almacen_idAlmacen, fecha, lugarDestino,
    lugarOrigen, tipo, activo FROM MovimientoAlmacen;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_mov_almacenes_activos
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_mov_almacenes_activos`()
BEGIN
	SELECT idMovAlmacen, Almacen_idAlmacen, fecha, lugarDestino,
    lugarOrigen, tipo, activo FROM MovimientoAlmacen
    WHERE activo=1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_ordenes_de_compra
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_ordenes_de_compra`()
BEGIN
	SELECT 
    ordcomp.idCompra as id_orden_compra,
    ordcomp.fechaLlegada as fecha_llegada_orden_compra,
    ordcomp.fechaEmision as fecha_emision_orden_compra,
    ordcomp.deudaPendiente as deuda_pendiente_orden_compra,
    ordcomp.montoTotal as monto_total_orden_compra,
    ordcomp.activo as activo_orden_compra,
    
    ordcomp.Proveedor_idProveedor as id_proveedor,
    prove.RUC as ruc_proveedor,
    prove.nombre as nombre_proveedor,
    prove.telefono as telefono_proveedor,
    prove.direccion as direccion_proveedor,
    prove.activo as activo_prooveedor,
    
    ordcomp.Empleado_idEmpleado as id_empleado,
    empl.sueldo as sueldo_empleado,
    empl.Cargo_idCargo as empleado_cargoId,
    carg.abreviatura as empleado_abreviatura,
    carg.descripcion as empleado_descripcion,
    carg.activo as cargo_activo,
    
    empl.activo as activo_empleado,
    person_empl.nombre as nombre_empleado,
    person_empl.primerApellido as primer_ape_empleado,
    person_empl.segundoApellido as segun_ape_empleado,
    person_empl.dni as dni_empleado,
    person_empl.telefono as telefono_empleado,
    person_empl.genero as genero_empleado

    FROM
    OrdenCompra ordcomp INNER JOIN Proveedor prove ON
    ordcomp.Proveedor_idProveedor = prove.idProveedor
    INNER JOIN Empleado empl ON
    ordcomp.Empleado_idEmpleado  = empl.idEmpleado
    INNER JOIN Cargo carg ON
    empl.Cargo_idCargo = carg.idCargo
    INNER JOIN Persona person_empl ON
    person_empl.idPersona = empl.idEmpleado;
    
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_pantalones
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_pantalones`()
BEGIN
  SELECT *
    FROM Prenda   p
    JOIN Pantalon t ON t.idPrenda = p.idPrenda
	WHERE p.activo = 1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_polos
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_polos`()
BEGIN
	SELECT * FROM Prenda INNER JOIN Polo ON Prenda.idPrenda = Polo.idPrenda WHERE Prenda.activo = 1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_prenda_lote
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_prenda_lote`()
BEGIN
  SELECT * FROM PrendaLote WHERE activo = 1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_promocioncomboXPrenda
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_promocioncomboXPrenda`(in indP int)
BEGIN
	select  pc.idPromocion as idPromocion, pp.nombre as nombre, pc.cantidadRequerida as cantidadRequerida, pc.cantidadGratis as cantidadGratis 
    from PrendaPromocion p , PromocionCombo pc, Promocion pp 
    where p.idPrenda=indP and p.idPromocion=pc.idPromocion and pp.idPromocion=pc.idPromocion and p.activo=1;

END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_promocionconjuntoXPrenda
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_promocionconjuntoXPrenda`(in indP int)
BEGIN
	select  pc.idPromocion as idPromocion, pp.nombre as nombre, pc.porcentajePromocion as porcentajePromocion
    from PrendaPromocion p , PromocionConjunto pc, Promocion pp 
    where p.idPrenda=indP and p.idPromocion=pc.idPromocion and pp.idPromocion=pc.idPromocion and p.activo=1;

END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_promocionescombo
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_promocionescombo`()
Begin

select p.idPromocion as idPromocion,p.nombre as nombre, pp.cantidadRequerida as cantidadRequerida, pp.cantidadGratis as cantidadGratis,p.idVigencia as idVigencia,p.activo as activo, p.esAutomatico as esAutomatico
    from PromocionCombo pp, Promocion p where p.idPromocion=pp.idPromocion;
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_promocionescombo_activo
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_promocionescombo_activo`()
Begin

select p.idPromocion as idPromocion,p.nombre as nombre, pp.cantidadRequerida as cantidadRequerida, pp.cantidadGratis as cantidadGratis,p.idVigencia as idVigencia,p.activo as activo, p.esAutomatico as esAutomatico
    from PromocionCombo pp, Promocion p where pp.idPromocion=p.idPromocion and p.activo=1;
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_promocionesconjunto
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_promocionesconjunto`()
Begin
select p.idPromocion as idPromocion,p.nombre as nombre, pp.porcentajePromocion as porcentajePromocion,p.idVigencia as idVigencia,p.activo as activo, p.esAutomatico as esAutomatico
    from PromocionConjunto pp, Promocion p where p.idPromocion=pp.idPromocion;
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_promocionesconjunto_activo
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_promocionesconjunto_activo`()
Begin
select p.idPromocion as idPromocion,p.nombre as nombre, pp.porcentajePromocion as porcentajePromocion,p.idVigencia as idVigencia,p.activo as activo, p.esAutomatico as esAutomatico
    from PromocionConjunto pp, Promocion p where p.idPromocion=pp.idPromocion and p.activo=1;
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_proveedores
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_proveedores`()
BEGIN
  Select idProveedor,RUC,nombre,telefono,direccion,activo
  From Proveedor;
  END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_tipoCuentas
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_tipoCuentas`()
BEGIN
	SELECT *
    FROM TipoCuenta
    WHERE activo=1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_ventas
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_ventas`()
BEGIN
	SELECT 
    vent.idVenta as id_venta,
    vent.fecha as fecha_venta,
    vent.total as total_venta,
	vent.activo as estado_venta ,
    emple.idEmpleado as id_empleado,
    emple.sueldo as sueldo_empleado,
    emple.activo as estado_empleado,
    
    perEmple.nombre as nombre_empleado,
    perEmple.primerApellido as primerApellido_empleado,
    perEmple.segundoApellido as segundoApellido_empleado,
    perEmple.dni as dni_empleado,
    perEmple.telefono as telefono_empleado,
    perEmple.genero as genero_empleado,
    
    
    
    cargoEmple.idCargo as id_cargo_emple,
    cargoEmple.abreviatura as abreviatura_cargo,
    cargoEmple.descripcion as descripcion_emplea,
	cargoEmple.activo as activo_cargo_emple,
    clie.idCliente as id_cliente,
    clie.activo as activo_clie,
    
    tipoClie.tipoCliente as tipo_clie_id,
    tipoClie.abreviatura as abreviatura_clie,
    tipoClie.descripcion as descripcion_clie,
    perClie.dni as dni_clie,
    perClie.genero as genero_clie,
    
    perClie.nombre as nombre_clie,
    perClie.primerApellido as primerApellido_clie,
    perClie.segundoApellido as segundoApellido_clie,
    perClie.telefono as telefono_clie,
    vent.Comprobante_idComprobante as id_comprobante
    
    FROM
    Venta vent INNER JOIN Empleado emple ON
    vent.Empleado_idEmpleado = emple.idEmpleado 
    INNER JOIN Cliente clie 
    ON vent.Cliente_idCliente = clie.idCliente 
    INNER JOIN ComprobanteDePago compPag 
    ON vent.Comprobante_idComprobante = compPag.idComprobante
    INNER JOIN Persona perClie
    ON clie.idCliente = perClie.idPersona
    INNER JOIN Persona perEmple
    ON emple.idEmpleado =  perEmple.idPersona 
    INNER JOIN Cargo cargoEmple
    ON cargoEmple.idCargo = emple.Cargo_idCargo
    INNER JOIN TipoDeCliente tipoClie
    ON clie.tipoCliente = tipoClie.tipoCliente
    ;
    
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_ventas_activas
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_ventas_activas`()
BEGIN
	SELECT 
    vent.idVenta as id_venta,
    vent.fecha as fecha_venta,
    vent.total as total_venta,
	vent.activo as estado_venta ,
    emple.idEmpleado as id_empleado,
    emple.sueldo as sueldo_empleado,
    emple.activo as estado_empleado,
    
    perEmple.nombre as nombre_empleado,
    perEmple.primerApellido as primerApellido_empleado,
    perEmple.segundoApellido as segundoApellido_empleado,
    perEmple.dni as dni_empleado,
    perEmple.telefono as telefono_empleado,
    perEmple.genero as genero_empleado,
  
    
    
    cargoEmple.idCargo as id_cargo_emple,
    cargoEmple.abreviatura as abreviatura_cargo,
    cargoEmple.descripcion as descripcion_emplea,
	cargoEmple.activo as activo_cargo_emple,
    clie.idCliente as id_cliente,
    clie.activo as activo_clie,
    
    tipoClie.tipoCliente as tipo_clie_id,
    tipoClie.abreviatura as abreviatura_clie,
    tipoClie.descripcion as descripcion_clie,
    perClie.dni as dni_clie,
    perClie.genero as genero_clie,
   
    perClie.nombre as nombre_clie,
    perClie.primerApellido as primerApellido_clie,
    perClie.segundoApellido as segundoApellido_clie,
    perClie.telefono as telefono_clie,
    vent.Comprobante_idComprobante as id_comprobante
    
    FROM
    Venta vent INNER JOIN Empleado emple ON
    vent.Empleado_idEmpleado = emple.idEmpleado 
    INNER JOIN Cliente clie 
    ON vent.Cliente_idCliente = clie.idCliente 
    INNER JOIN ComprobanteDePago compPag 
    ON vent.Comprobante_idComprobante = compPag.idComprobante
    INNER JOIN Persona perClie
    ON clie.idCliente = perClie.idPersona
    INNER JOIN Persona perEmple
    ON emple.idEmpleado =  perEmple.idPersona 
    INNER JOIN Cargo cargoEmple
    ON cargoEmple.idCargo = emple.Cargo_idCargo
    INNER JOIN TipoDeCliente tipoClie
    ON clie.tipoCliente = tipoClie.tipoCliente
    WHERE vent.activo = 1;
    
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_vestidos
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_vestidos`()
BEGIN
  SELECT *
    FROM Prenda  p
    JOIN Vestido v ON v.idPrenda = p.idPrenda
    WHERE p.activo = 1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_vigencia
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_vigencia`()
BEGIN
	select idVigencia,fechaInicio,fechaFin,activo from Vigencia;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure mostrar_vigencia_activos
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `mostrar_vigencia_activos`()
BEGIN
	select idVigencia,fechaInicio,fechaFin,activo from Vigencia where activo=1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtenerId_cliente
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtenerId_cliente`( IN _idCliente INT)
BEGIN
  
	SELECT c.idCliente,c.activo,p.nombre,
    p.primerApellido,p.segundoApellido,
    p.dni,p.telefono,p.genero,
    t.tipoCliente,t.abreviatura,t.descripcion
    FROM Cliente c INNER JOIN 
	Persona p ON c.idCliente=p.idPersona
	INNER JOIN TipoDeCliente t ON c.tipoCliente = t.tipoCliente 
    where c.idCliente=_idCliente;
    
  END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtenerId_proveedor
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtenerId_proveedor`( IN _idProveedor INT)
BEGIN
  Select idProveedor,RUC,nombre,telefono,direccion,activo
  From Proveedor 
  WHERE  idProveedor = _idProveedor;
  END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_almacen_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_almacen_X_id`(
	IN _idAlmacen int
)
BEGIN
	SELECT idAlmacen, nombre, ubicacion, stock, Tienda_idTienda, activo
    FROM Almacen
    WHERE idAlmacen=_idAlmacen;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_blusa_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_blusa_X_id`(
    IN _id_prenda INT
)
BEGIN
  SELECT *
    FROM Prenda p
    JOIN Blusa  b ON b.idPrenda = p.idPrenda
   WHERE p.idPrenda = _id_prenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_boleta_x_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_boleta_x_id`(
    IN _id_Comprobante INT
)
BEGIN
    SELECT 
        b.idComprobante,
        p.correlativo,
        p.fecha,
        p.IGV,
        p.metodoDePago,
        p.total,
        b.DNI,
        p.activa
    FROM ComprobanteDePago p
    INNER JOIN Boleta b ON p.idComprobante = b.idComprobante
    WHERE b.idComprobante = _id_Comprobante
      AND p.activa = 1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_cargo_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_cargo_X_id`(
	IN _idCargo INT
)
BEGIN
	SELECT *
    FROM Cargo
    WHERE idCargo=_idCargo;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_casaca_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_casaca_X_id`(
    IN _id_prenda INT
)
BEGIN
    SELECT  p.idPrenda, p.nombre, p.stockPrenda, p.precioUnidad, p.precioMayor, p.precioDocena,
            p.alertaMinStock, p.color, p.material,
            c.tipo_casaca, c.con_capucha
      FROM  Prenda p
      JOIN  Casaca c ON c.idPrenda = p.idPrenda
     WHERE  p.idPrenda = _id_prenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_cuentaUsuarios_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_cuentaUsuarios_X_id`(
	IN _idCuenta INT
)
BEGIN
	SELECT c.idCuenta, c.username, c.contrasenha, c.email,
    c.activo, t.idTipoCuenta, t.descripcion
    FROM CuentaUsuario c
    INNER JOIN TipoCuenta t ON t.idTipoCuenta=c.TipoCuenta_idTipoCuenta
    WHERE idCuenta=_idCuenta;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_descuentoliquidacion_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_descuentoliquidacion_X_id`(in id int)
BEGIN
	select d.idDescuento as idDescuento, d.nombre as nombre, dp.porcentajeLiquidacion as porcentajeLiquidacion,dp.condicionStockMin as condicionStockMin,
    d.activo as activo,
    d.esAutomatico as esAutomatico, d.idVigencia as idVigencia from DescuentoLiquidacion dp, Descuento d 
    where d.idDescuento=id and dp.idDescuento=id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_descuentomonto_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_descuentomonto_X_id`(in id int)
BEGIN
	select d.idDescuento as idDescuento, d.nombre as nombre, dp.montoEditable as montoEditable,dp.montoMaximo as montoMaximo,
    d.activo as activo,
    d.esAutomatico as esAutomatico, d.idVigencia as idVigencia from DescuentoMonto dp, Descuento d 
    where d.idDescuento=id and dp.idDescuento=id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_descuentoporcentaje_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_descuentoporcentaje_X_id`(in id int)
BEGIN
	select d.idDescuento as idDescuento, d.nombre as nombre, dp.porcentaje as porcentaje,d.activo as activo,
    d.esAutomatico as esAutomatico, d.idVigencia as idVigencia from DescuentoPorcentaje dp, Descuento d 
    where d.idDescuento=id and dp.idDescuento=id;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_empleado_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_empleado_X_id`(
	IN _idEmpleado INT
)
BEGIN
	SELECT p.idPersona, p.nombre, p.primerApellido, p.segundoApellido,
    p.dni, p.telefono, p.genero, e.activo, e.sueldo, c.idCargo,
    c.abreviatura, c.descripcion
    FROM Persona p
    INNER JOIN Empleado e ON p.idPersona=e.idEmpleado
    INNER JOIN Cargo c ON c.idCargo=e.Cargo_idCargo
    WHERE e.idEmpleado=_idEmpleado;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_factura_x_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_factura_x_id`(
    IN _id_Comprobante INT
)
BEGIN
    SELECT 
        f.idComprobante,
        p.correlativo,
        p.fecha,
        p.IGV,
        p.metodoDePago,
        p.total,
        f.RUC,
        f.razonSocial,
        p.activa
    FROM ComprobanteDePago p
    INNER JOIN Factura f ON p.idComprobante = f.idComprobante
    WHERE f.idComprobante = _id_Comprobante
      AND p.activa = 1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_falda_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_falda_X_id`(
    IN _id_prenda INT
)
BEGIN
    SELECT  p.idPrenda, p.nombre, p.stockPrenda, p.precioUnidad, p.precioMayor, p.precioDocena,
            p.alertaMinStock, p.color, p.material,
            c.tipo_falda, c.largo, c.con_forro, c.con_volantes
      FROM  Prenda p
      JOIN  Falda c ON c.idPrenda = p.idPrenda
     WHERE  p.idPrenda = _id_prenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_gorro_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_gorro_X_id`(
    IN _id_prenda INT
)
BEGIN
  SELECT *
    FROM Prenda p
    JOIN Gorro  g ON g.idPrenda = p.idPrenda
   WHERE p.idPrenda = _id_prenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_lote_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_lote_X_id`(
	_idLote int
)
BEGIN
	SELECT*FROM Lote WHERE _idLote=idLote;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_mov_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_mov_X_id`(
	_idMovAlmacen int
)
BEGIN
	SELECT idMovAlmacen, Almacen_idAlmacen, fecha,
    lugarDestino, lugarOrigen, tipo, activo
    FROM MovimientoAlmacen
    WHERE idMovAlmacen=_idMovAlmacen;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_mov_X_lote_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_mov_X_lote_X_id`(
	_idMovAlmacen_X_Lote int
)
BEGIN
    SELECT*FROM MovimientoAlmacen_X_Lote WHERE _idMovAlmacen_X_Lote=idMovAlmacen_X_Lote;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_nota_de_credito_x_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_nota_de_credito_x_id`(
    IN _id_Comprobante INT
)
BEGIN
    SELECT 
        n.idComprobante,
        p.correlativo,
        p.fecha,
        p.IGV,
        p.metodoDePago,
        p.total,
        n.detalleModificacion,
        n.RUC,
        n.razonSocial,
        n.DNI,
        n.motivoEspecifico,
        n.nuevoMonto,
        n.valorAumentar,
        p.activa
    FROM ComprobanteDePago p
    INNER JOIN NotaDeCredito n ON p.idComprobante = n.idComprobante
    WHERE n.idComprobante = _id_Comprobante
      AND p.activa = 1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_nota_de_debito_x_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_nota_de_debito_x_id`(
    IN _id_Comprobante INT
)
BEGIN
    SELECT 
        n.idComprobante,
        p.correlativo,
        p.fecha,
        p.IGV,
        p.metodoDePago,
        p.total,
        n.detalleModificacion,
        n.RUC,
        n.razonSocial,
        n.motivoEspecifico,
        n.nuevoMonto,
        n.valorAumentar,
        n.idPrenda,
        p.activa
    FROM ComprobanteDePago p
    INNER JOIN NotaDeDebito n ON p.idComprobante = n.idComprobante
    WHERE n.idComprobante = _id_Comprobante
      AND p.activa = 1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_orden_de_compra_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_orden_de_compra_X_id`(
	IN _idCompra INT
)
BEGIN
	SELECT 
    ordcomp.idCompra as id_orden_compra,
    ordcomp.fechaLlegada as fecha_llegada_orden_compra,
    ordcomp.fechaEmision as fecha_emision_orden_compra,
    ordcomp.deudaPendiente as deuda_pendiente_orden_compra,
    ordcomp.montoTotal as monto_total_orden_compra,
    ordcomp.activo as activo_orden_compra,
    
    ordcomp.Proveedor_idProveedor as id_proveedor,
    prove.RUC as ruc_proveedor,
    prove.nombre as nombre_proveedor,
    prove.telefono as telefono_proveedor,
    prove.direccion as direccion_proveedor,
    prove.activo as activo_prooveedor,
    
    ordcomp.Empleado_idEmpleado as id_empleado,
    empl.sueldo as sueldo_empleado,
    empl.Cargo_idCargo as empleado_cargoId,
    carg.abreviatura as empleado_abreviatura,
    carg.descripcion as empleado_descripcion,
    carg.activo as cargo_activo,
    
    empl.activo as activo_empleado,
    person_empl.nombre as nombre_empleado,
    person_empl.primerApellido as primer_ape_empleado,
    person_empl.segundoApellido as segun_ape_empleado,
    person_empl.dni as dni_empleado,
    person_empl.telefono as telefono_empleado,
    person_empl.genero as genero_empleado

    FROM
    OrdenCompra ordcomp INNER JOIN Proveedor prove ON
    ordcomp.Proveedor_idProveedor = prove.idProveedor
    INNER JOIN Empleado empl ON
    ordcomp.Empleado_idEmpleado  = empl.idEmpleado
    INNER JOIN Cargo carg ON
    empl.Cargo_idCargo = carg.idCargo
    INNER JOIN Persona person_empl ON
    person_empl.idPersona = empl.idEmpleado
    WHERE ordcomp.idCompra = _idCompra;
    
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_pantalon_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_pantalon_X_id`(
    IN _id_prenda INT
)
BEGIN
  SELECT *
    FROM Prenda   p
    JOIN Pantalon t ON t.idPrenda = p.idPrenda
   WHERE p.idPrenda = _id_prenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_polo_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_polo_X_id`(
    IN _id_prenda INT
)
BEGIN
    SELECT  p.idPrenda, p.nombre, p.stockPrenda, p.precioUnidad, p.precioMayor, p.precioDocena,
            p.alertaMinStock, p.color, p.material,
            po.tipo_manga, po.estampado, po.tipo_cuello
      FROM  Prenda p
      JOIN  Polo   po ON po.idPrenda = p.idPrenda
     WHERE  p.idPrenda = _id_prenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_prenda_lote_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_prenda_lote_X_id`(
    IN _id_prenda_lote INT
)
BEGIN
  SELECT *
    FROM PrendaLote
   WHERE idPrendaLote = _id_prenda_lote;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_promocioncombo_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_promocioncombo_X_id`(in id int)
Begin 
	select p.idPromocion as idPromocion,p.nombre as nombre, pp.cantidadRequerida as cantidadRequerida, pp.cantidadGratis as cantidadGratis,p.idVigencia as idVigencia,p.activo as activo, p.esAutomatico as esAutomatico
    from PromocionCombo pp, Promocion p where p.idPromocion=id and pp.idPromocion=id;
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_promocionconjunto_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_promocionconjunto_X_id`(in id int)
Begin 
	select p.idPromocion as idPromocion,p.nombre as nombre, pp.porcentajePromocion as porcentajePromocion,p.idVigencia as idVigencia,p.activo as activo, p.esAutomatico as esAutomatico
    from PromocionConjunto pp, Promocion p where p.idPromocion=id and pp.idPromocion=id;
End$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_stock_prenda_talla
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_stock_prenda_talla`(
    IN _id_prenda INT,
    IN _talla     ENUM('XS','S','M','L','XL','XXL')
)
BEGIN
  SELECT COALESCE(SUM(stock), 0) AS stock_total
    FROM PrendaLote
   WHERE Prenda_idPrenda = _id_prenda
     AND talla           = _talla
     AND activo          = 1;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_tipoCuenta_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_tipoCuenta_X_id`(
	IN _idTipoCuenta INT
)
BEGIN
	SELECT *
    FROM TipoCuenta
    WHERE idTipoCuenta=_idTipoCuenta;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_venta_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_venta_X_id`(
	IN _idVenta INT
)
BEGIN
	SELECT 
    vent.idVenta as id_venta,
    vent.fecha as fecha_venta,
    vent.total as total_venta,
	vent.activo as estado_venta ,
    emple.idEmpleado as id_empleado,
    emple.sueldo as sueldo_empleado,
    emple.activo as estado_empleado,
    
    perEmple.nombre as nombre_empleado,
    perEmple.primerApellido as primerApellido_empleado,
    perEmple.segundoApellido as segundoApellido_empleado,
    perEmple.dni as dni_empleado,
    perEmple.telefono as telefono_empleado,
    perEmple.genero as genero_empleado,
    
    
    
    cargoEmple.idCargo as id_cargo_emple,
    cargoEmple.abreviatura as abreviatura_cargo,
    cargoEmple.descripcion as descripcion_emplea,
	cargoEmple.activo as activo_cargo_emple,
    clie.idCliente as id_cliente,
    clie.activo as activo_clie,
    
    
    tipoClie.tipoCliente as tipo_clie_id,
    tipoClie.abreviatura as abreviatura_clie,
    tipoClie.descripcion as descripcion_clie,
    perClie.dni as dni_clie,
    perClie.genero as genero_clie,
    perClie.nombre as nombre_clie,
    perClie.primerApellido as primerApellido_clie,
    perClie.segundoApellido as segundoApellido_clie,
    perClie.telefono as telefono_clie,
    vent.Comprobante_idComprobante as id_comprobante
    
    FROM
    Venta vent INNER JOIN Empleado emple ON
    vent.Empleado_idEmpleado = emple.idEmpleado 
    INNER JOIN Cliente clie 
    ON vent.Cliente_idCliente = clie.idCliente 
    INNER JOIN ComprobanteDePago compPag 
    ON vent.Comprobante_idComprobante = compPag.idComprobante
    INNER JOIN Persona perClie
    ON clie.idCliente = perClie.idPersona
    INNER JOIN Persona perEmple
    ON emple.idEmpleado =  perEmple.idPersona 
    INNER JOIN Cargo cargoEmple
    ON cargoEmple.idCargo = emple.Cargo_idCargo
    INNER JOIN TipoDeCliente tipoClie
    ON clie.tipoCliente = tipoClie.tipoCliente
    WHERE vent.idVenta = _idVenta;
    
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_vestido_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_vestido_X_id`(
    IN _id_prenda INT
)
BEGIN
  SELECT *
    FROM Prenda  p
    JOIN Vestido v ON v.idPrenda = p.idPrenda
   WHERE p.idPrenda = _id_prenda;
END$$

DELIMITER ;

-- -----------------------------------------------------
-- procedure obtener_vigencia_X_id
-- -----------------------------------------------------

DELIMITER $$
USE `mydb`$$
CREATE DEFINER=`admin`@`%` PROCEDURE `obtener_vigencia_X_id`(in id int)
BEGIN
	select idVigencia,fechaInicio,fechaFin,activo from Vigencia where idVigencia=id;
END$$

DELIMITER ;

DROP PROCEDURE IF EXISTS mostrar_proveedores_activos ;

DELIMITER $
CREATE PROCEDURE mostrar_proveedores_activos()
BEGIN
    SELECT 
        idProveedor,
        RUC,
        nombre,
        telefono,
        direccion,
        activo
    FROM Proveedor
    WHERE activo = 1;
END$

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

ALTER TABLE Almacen AUTO_INCREMENT = 1;
ALTER TABLE Tienda AUTO_INCREMENT = 1;
ALTER TABLE MovimientoAlmacen AUTO_INCREMENT = 1;
ALTER TABLE Lote AUTO_INCREMENT = 1;
ALTER TABLE MovimientoAlmacen_X_Lote AUTO_INCREMENT = 1;

INSERT INTO Tienda (idTienda, nombre, ubicacion) 
VALUES (1, 'WearDrop', 'Calle 7, Edificio 253 Piso 3');